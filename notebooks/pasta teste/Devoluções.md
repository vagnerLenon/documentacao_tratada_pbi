# Documentação Power BI - Devoluções
**Data:** *05/11/2022 22:12:01*

**Nome do arquivo:** *Devoluções.pbix*

**Caminho do arquivo .pbix:** *I:\03.DADOPAR\ADMINISTRATIVO\BI\VAGNER\POWER BI\ONLINE\COMERCIAL OPERACIONAL\DEVOLUCOES\Devoluções.pbix*

---

## Lista de páginas:

|DisplayName|Name|Ordinal|DisplayOption|Width|Height|PageIndex|
|---|---|---|---|---|---|---|
|Home|ReportSectionf006ae245620d788e624|0|1|1920|1080|0|
|Relatório|ReportSectiona2845233991e3e9977b4|1|1|1920|1080|1|
---

## Lista de visuais por relatório:

### Visuais em Home:

|Visual Type|Title|X|Y|Z|Width|Height|Name|tabOrder|VisualIndex|PageIndex|
|---|---|---|---|---|---|---|---|---|---|---|
|image||0|0|3000|17883149872989|14956816257409|7372684b749e6794e9a0||0|0|
|ChicletSlicer1448559807354|'Canal'|0|210510396975425|6000|282878916172735|89415749364945|4e83e5b882a779576eee|3000|1|0|
|ChicletSlicer1448559807354|'UF'|283|210510396975425|9000|239|88|37efd240112ee6b4043e|6000|2|0|
|ChicletSlicer1448559807354|'Tipo de devolução'|522|210510396975425|10000|343|88|4810aa3de605120913b9|9000|3|0|
|ChicletSlicer1448559807354|'Ano'|1160|210510396975425|11000|243|88|df72b1426e2ddadb19d8|10000|4|0|
|ChicletSlicer1448559807354|'Mês'|1402797731569|210510396975425|12000|517202268431002|871077504725898|345e5de08651723c35ce|11000|5|0|
|textbox||432447078746825|162574089754445|13000|105510584250635|133310753598645|79a256f0555246518ee5|12000|6|0|
|pivotTable||597299035369775|344180064308682|14000|723858520900322|720771704180064|53f9af3d185780c90797|13000|7|0|
|shape||0|136105860113422|0|1920|961814744801512|c5cae3e63809eb1485d9|14000|8|0|
|actionButton||17213349230713|8234567925405|7000|170928626247122|574673829623945|ac4e74c89a272f70c045|7000|9|0|
|textbox||172139107292956|855946768576963|4000|170816326530612|50969387755102|0787dcfcc690992f1775|4000|10|0|
|shape||17213349230713|8234567925405|1000|170928626247122|574673829623945|707b11554cfe9f8555ca|1000|11|0|
|actionButton||172113945578231|425170068027211|8000|170816326530612|564795918367347|e4a7332ee6c14a9d5c52|8000|12|0|
|textbox||172113945578231|700680272108844|5000|170816326530612|50969387755102|1f237578a07fb723d127|5000|13|0|
|shape||172113945578231|425170068027211|2000|170816326530612|564795918367347|3a456f7d454ab54dbaab|2000|14|0|
|pivotTable||135048231511254|344180064308682|15000|561800643086817|720771704180064|c1e61bf15dd6f0f8a73b|15000|15|0|
|pivotTable||0|344180064308682|16000|583408360128617|720771704180064|b18aee31a9fe77f99877|16000|16|0|
### Visuais em Relatório:

|Visual Type|Title|X|Y|Z|Width|Height|Name|tabOrder|VisualIndex|PageIndex|
|---|---|---|---|---|---|---|---|---|---|---|
|image||0|0|3000|17883149872989|14956816257409|f3c7cb5da0b360834180||0|1|
|shape||171780612244898|0|0|170816326530612|564795918367347|5fc1d20717514e7dc1ac|6000|1|1|
|textbox||171780612244898|551020408163265|4000|170816326530612|50969387755102|783149ec03d257193a8c|1000|2|1|
|actionButton||171780612244898|0|6000|170816326530612|564795918367347|57778428d48d27bce478|3000|3|1|
|ChicletSlicer1448559807354|'Canal'|0|212325141776938|7000|282878916172735|89415749364945|3eec4430b8be50aee3d0|4000|4|1|
|ChicletSlicer1448559807354|'UF'|283|212325141776938|9000|239|88|9c4872d095ed4450a7b0|7000|5|1|
|ChicletSlicer1448559807354|'Tipo de devolução'|522|212325141776938|10000|343|88|734deacd23a0a7557548|9000|6|1|
|tableEx||907372400756144|342986767485822|11000|190003780718336|736786389413989|2511e9b012d05655a3a7|10000|7|1|
|ChicletSlicer1448559807354|'Ano'|1160|212325141776938|12000|243|88|b8a5598a320ab27410d0|11000|8|1|
|ChicletSlicer1448559807354|'Mês'|1402797731569|212325141776938|13000|517202268431002|871077504725898|9c7a895341a2abdbb34e|12000|9|1|
|textbox||432447078746825|162574089754445|14000|105510584250635|133310753598645|21ad119a4d0d9aa91665|13000|10|1|
|shape||171800158973797|790123459207167|1000|170928626247122|574673829623945|ab8b35d0173014e68396|8000|11|1|
|textbox||171805773959622|822613435243629|5000|170816326530612|50969387755102|d5aa4e2a5081a45e1c54|5000|12|1|
|actionButton||171800158973797|790123459207167|8000|170928626247122|574673829623945|f38fbd121a563ccc18a7|2000|13|1|
|shape||0|136105860113422|2000|1920|961814744801512|27f55178e74399b0995c|14000|14|1|
---

## Lista de todas as Colunas/Campos/Medidas/Expressões usadas nos visuais:

|Name|Table Name|Aggregation|Expression|VisualIndex|PageIndex|
|---|---|---|---|---|---|
|Canal|DEVOLUÇÕES||DEVOLUÇÕES.Canal|1|0|
|Volume|Medidas||Medidas.Volume|1|0|
|Volume|Medidas||Medidas.Volume|2|0|
|ClienteUF|DEVOLUÇÕES||DEVOLUÇÕES.ClienteUF|2|0|
|Volume|Medidas||Medidas.Volume|3|0|
|TipoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.TipoDevolucao|3|0|
|Volume|Medidas||Medidas.Volume|4|0|
|Ano|||DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Ano|4|0|
|Volume|Medidas||Medidas.Volume|5|0|
|Mês|||DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Mês|5|0|
|Volume|Medidas||Medidas.Volume|7|0|
|PrecoTotal|Medidas||Medidas.PrecoTotal|7|0|
|Rede_Label|DEVOLUÇÕES||DEVOLUÇÕES.Rede_Label|7|0|
|Cliente_Label|DEVOLUÇÕES||DEVOLUÇÕES.Cliente_Label|7|0|
|NFDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.NFDevolucao|7|0|
|Rede_Label|DEVOLUÇÕES||DEVOLUÇÕES.Rede_Label|7|0|
|Volume|Medidas||Medidas.Volume|15|0|
|PrecoTotal|Medidas||Medidas.PrecoTotal|15|0|
|Linha|PRODUTOS||PRODUTOS.Linha|15|0|
|Produto|PRODUTOS||PRODUTOS.Produto|15|0|
|Produto|PRODUTOS||PRODUTOS.Produto|15|0|
|Volume|Medidas||Medidas.Volume|16|0|
|PrecoTotal|Medidas||Medidas.PrecoTotal|16|0|
|TipoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.TipoDevolucao|16|0|
|MotivoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.MotivoDevolucao|16|0|
|MotivoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.MotivoDevolucao|16|0|
|Canal|DEVOLUÇÕES||DEVOLUÇÕES.Canal|4|1|
|Volume|Medidas||Medidas.Volume|4|1|
|Volume|Medidas||Medidas.Volume|5|1|
|ClienteUF|DEVOLUÇÕES||DEVOLUÇÕES.ClienteUF|5|1|
|Volume|Medidas||Medidas.Volume|6|1|
|TipoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.TipoDevolucao|6|1|
|EntradaDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.EntradaDevolucao|7|1|
|EmissaoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.EmissaoDevolucao|7|1|
|MotivoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.MotivoDevolucao|7|1|
|TipoDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.TipoDevolucao|7|1|
|TipoOperacao|DEVOLUÇÕES||DEVOLUÇÕES.TipoOperacao|7|1|
|DescCFOP|DEVOLUÇÕES||DEVOLUÇÕES.DescCFOP|7|1|
|Cliente|DEVOLUÇÕES||DEVOLUÇÕES.Cliente|7|1|
|ClienteFantasia|DEVOLUÇÕES||DEVOLUÇÕES.ClienteFantasia|7|1|
|ClienteRazao|DEVOLUÇÕES||DEVOLUÇÕES.ClienteRazao|7|1|
|ClienteUF|DEVOLUÇÕES||DEVOLUÇÕES.ClienteUF|7|1|
|ClienteMunicipio|DEVOLUÇÕES||DEVOLUÇÕES.ClienteMunicipio|7|1|
|Rede|DEVOLUÇÕES||DEVOLUÇÕES.Rede|7|1|
|RedeFantasia|DEVOLUÇÕES||DEVOLUÇÕES.RedeFantasia|7|1|
|RedeRazao|DEVOLUÇÕES||DEVOLUÇÕES.RedeRazao|7|1|
|NomeRota|DEVOLUÇÕES||DEVOLUÇÕES.NomeRota|7|1|
|Canal|DEVOLUÇÕES||DEVOLUÇÕES.Canal|7|1|
|Supervisor|DEVOLUÇÕES||DEVOLUÇÕES.Supervisor|7|1|
|Vendedor|DEVOLUÇÕES||DEVOLUÇÕES.Vendedor|7|1|
|SerieDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.SerieDevolucao|7|1|
|NFDevolucao|DEVOLUÇÕES||DEVOLUÇÕES.NFDevolucao|7|1|
|EmissaoOriginal|DEVOLUÇÕES||DEVOLUÇÕES.EmissaoOriginal|7|1|
|SerieOriginal|DEVOLUÇÕES||DEVOLUÇÕES.SerieOriginal|7|1|
|NfOriginal|DEVOLUÇÕES||DEVOLUÇÕES.NfOriginal|7|1|
|CdTransportadora|DEVOLUÇÕES||DEVOLUÇÕES.CdTransportadora|7|1|
|FantasiaTransportadora|DEVOLUÇÕES||DEVOLUÇÕES.FantasiaTransportadora|7|1|
|Linha|PRODUTOS||PRODUTOS.Linha|7|1|
|CodProduto|DEVOLUÇÕES||DEVOLUÇÕES.CodProduto|7|1|
|Produto|PRODUTOS||PRODUTOS.Produto|7|1|
|Apelido|PRODUTOS||PRODUTOS.Apelido|7|1|
|Quantidade|DEVOLUÇÕES|Sum|Sum(DEVOLUÇÕES.Quantidade)|7|1|
|Volume|DEVOLUÇÕES|Sum|Sum(DEVOLUÇÕES.Volume)|7|1|
|PrecoTotal|DEVOLUÇÕES|Sum|Sum(DEVOLUÇÕES.PrecoTotal)|7|1|
|Volume|Medidas||Medidas.Volume|8|1|
|Ano|||DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Ano|8|1|
|Volume|Medidas||Medidas.Volume|9|1|
|Mês|||DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Mês|9|1|
---

## Lista das Tabelas usadas nos visuais:

|Name|
|---|
|DEVOLUÇÕES|
|Medidas|
|LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d|
|PRODUTOS|
---

## Lista das Colunas NÃO usadas nos visuais:

|Name|Table Name|State|Data Category|Data Type|Description|Display Folder|Error Message|Format String|Is Hidden|Modified Time|Structure Modified Time|Sort by Column|Summarize By|Type|Expression|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|CFOP|DEVOLUÇÕES|||||||||||||COLUMN||
|Movimento|DEVOLUÇÕES|||||||||||||COLUMN||
|CdRota|DEVOLUÇÕES|||||||||||||COLUMN||
|Usuario|DEVOLUÇÕES|||||||||||||COLUMN||
|CdUsuario|DEVOLUÇÕES|||||||||||||COLUMN||
|NomeUsuario|DEVOLUÇÕES|||||||||||||COLUMN||
|DescProduto|DEVOLUÇÕES|||||||||||||COLUMN||
|TipoIndenizacao|DEVOLUÇÕES|||||||||||||COLUMN||
|ChaveNfOriginal|DEVOLUÇÕES|||||||||||||COLUMN||
|RazaoTransportadora|DEVOLUÇÕES|||||||||||||COLUMN||
|CNPJTransportadora|DEVOLUÇÕES|||||||||||||COLUMN||
|IPI|DEVOLUÇÕES|||||||||||||COLUMN||
|ICMS|DEVOLUÇÕES|||||||||||||COLUMN||
|CdProduto|PRODUTOS|||||||||||||COLUMN||
|UniMed|PRODUTOS|||||||||||||COLUMN||
|CdGrupo|PRODUTOS|||||||||||||COLUMN||
|Grupo|PRODUTOS|||||||||||||COLUMN||
|CdSubgrupo|PRODUTOS|||||||||||||COLUMN||
|Subgrupo|PRODUTOS|||||||||||||COLUMN||
|Agrupamento|PRODUTOS|||||||||||||COLUMN||
|Quantidade|Medidas|||||||||||||MEASURE||
---

## Modelo:

## Modelo: Devoluções

---

## Lista de Tabelas:

|Name|Description|Storage Mode|Source|Is Hidden|
|---|---|---|---|---|
|DateTableTemplate_56af38da-5a48-4aa0-89f3-22215533f47c||Import|Calendar(Date(2015,1,1), Date(2015,1,1))|True|
|DEVOLUÇÕES||Import|let  Fonte = Sql.Database("192.168.1.249\DADOBIER_BI", "DADOBIER_ETL", [Query="--CREATE VIEW [dbo].[RELATORIO_DEVOLUCOES] AS#(lf)SELECT#(lf) -- Dados categoricos#(lf)--#(lf) -- Dados base#(lf)#(tab)M.MOVIMENTO AS Movimento,#(lf)#(tab)M.CFOP AS CFOP,#(lf)#(tab)M.CD_TP_OPERACAO AS TipoOperacao,#(lf)#(tab)TP.DESCRICAO AS DescCFOP,#(lf)--#(lf) -- Dados Cliente#(lf)#(tab)E.CD_EMPRESA AS Cliente,#(lf)#(tab)E.NOME_COMPLETO AS ClienteRazao,#(lf)#(tab)E.FANTASIA AS ClienteFantasia,#(lf)#(tab)E.UF AS ClienteUF,#(lf)#(tab)E.MUNICIPIO AS ClienteMunicipio,#(lf)#(tab)ISNULL(E.TIPO_DE_EMPRESA, '00') AS CdRota,#(lf)#(tab)ISNULL(ROTA.DESCRICAO, 'SEM ROTA DEFINIDA') AS NomeRota,#(lf)#(tab)ISNULL(R.CD_EMPRESA , E.CD_EMPRESA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Rede,#(lf)#(tab)CASE WHEN TRIM(ISNULL(R.NOME_COMPLETO, '')) = '' THEN E.NOME_COMPLETO ELSE R.NOME_COMPLETO END AS RedeRazao,#(lf)#(tab)ISNULL(R.FANTASIA , E.FANTASIA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS RedeFantasia,#(lf)--#(lf) -- Dados nota#(lf)#(tab)M.SERIE AS SerieDevolucao, #(lf) M.NF AS NFDevolucao,#(lf)#(tab)ENT.DT_EMISSAO AS EmissaoDevolucao,#(lf)#(tab)M.DT_MOVIMENTO AS EntradaDevolucao,#(lf)#(tab)U.USUARIO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Usuario,#(lf)#(tab)M.USU_CRIACAO AS CdUsuario,#(lf)#(tab)U.NOME#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS NomeUsuario,#(lf)--#(lf) -- Dados de produto#(lf)#(tab)MAT.CD_MATERIAL #(tab)#(tab)AS CodProduto,#(lf)#(tab)MAT.DESCRICAO AS DescProduto,#(lf)--#(lf) -- Dados devolucao#(lf) CASE WHEN TRIM(ISNULL(D.DESCRICAO, '')) = '' THEN 'SEM MOTIVO INFORMADO' ELSE D.DESCRICAO END#(tab)#(tab)AS MotivoDevolucao,#(lf)#(tab)CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END AS TipoIndenizacao,#(lf)#(tab)CASE#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'P' THEN 'RETORNO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'N' THEN 'NÃO INDENIZADO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'V' THEN 'INDENIZADO'#(lf)#(tab)#(tab)ELSE 'NÃO ENCONTRADO'#(lf)#(tab)END #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS TipoDevolucao,#(lf)--#(lf)#(tab)-- Dados NF referencia#(lf) ENT.NF_REFERENCIA AS NfOriginal,#(lf)#(tab)ENT.SERIE_REFERENCI AS SerieOriginal,#(lf)#(tab)NOTA_ORIGINAL.DT_EMISSAO AS EmissaoOriginal,#(lf)#(tab)CONCAT(FORMAT(ENT.NF_REFERENCIA, '0000000000'), '.', ENT.SERIE_REFERENCI)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS ChaveNfOriginal,#(lf)--#(lf) -- Dados responsabilidade#(lf)#(tab)ISNULL(H.SUPERVISOR, 'SEM SUPERVISOR DEFINIDO') #(tab)AS Supervisor,#(lf)#(tab)ISNULL(H.VENDEDOR, 'SEM VENDEDOR DEFINIDO') #(tab)AS Vendedor,#(lf)#(tab)CASE #(tab)#(lf)#(tab)#(tab)WHEN H.CANAL IS NULL AND E.UF = 'EX' THEN 'EXPORTAÇÃO'#(lf)#(tab)#(tab)ELSE ISNULL(H.CANAL, 'SEM CANAL DEFINIDO')#(lf)#(tab)END#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Canal,#(lf)--#(lf) -- Dados Transportadora da nota original#(lf) TRANSP.CD_EMPRESA AS CdTransportadora,#(lf)#(tab)TRANSP.NOME_COMPLETO AS RazaoTransportadora,#(lf)#(tab)TRANSP.FANTASIA AS FantasiaTransportadora,#(lf)#(tab)TRANSP.CNPJ_CPF AS CNPJTransportadora,#(lf)--#(lf) -- Dados Numericos#(lf)#(tab)M.QUANTIDADE AS Quantidade,#(lf)#(tab)CASE WHEN M.UNI_MED = 'UN' THEN MAT.PESO ELSE 1 END * M.QUANTIDADE AS Volume,#(lf)#(tab)M.PR_TOTAL_ITEM + M.VL_DESCONTO + M.TOTAL_DESP_ITEM + M.VL_IPI + M.VL_SUBSTITUICAO AS PrecoTotal,#(lf)#(tab)M.VL_IPI AS IPI,#(lf)#(tab)M.VL_ICMS AS ICMS#(lf)--#(lf)FROM CIGAM_RAW_DATA.dbo.ESMOVIME M#(lf)LEFT JOIN CIGAM_AUX.dbo.GETOPERA TP ON TP.CD_TIPO_OPERACA = M.CD_TP_OPERACAO#(lf)LEFT JOIN CIGAM_AUX.dbo.ESMATERI MAT ON MAT.CD_MATERIAL = M.CD_MATERIAL#(lf)LEFT JOIN CIGAM_CORE.dbo.COENTRAD ENT ON ENT.NF = M.NF AND ENT.SERIE = M.SERIE AND ENT.CD_FORNECEDOR = M.CD_EMPRESA AND ENT.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN DADOBIER_DW.dbo.TB_MOTIVOS_DEVOLUCAO D ON D.MOVIMENTO = M.MOVIMENTO#(lf)--#(lf)LEFT JOIN CIGAM_CORE.dbo.FANFISCA NOTA_ORIGINAL ON NOTA_ORIGINAL.NF = ENT.NF_REFERENCIA AND NOTA_ORIGINAL.SERIE = 'NFE' AND NOTA_ORIGINAL.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES E ON E.CD_EMPRESA = CASE WHEN M.CD_EMPRESA = '000001' THEN NOTA_ORIGINAL.CD_CLIENTE ELSE M.CD_EMPRESA END#(lf)LEFT JOIN CIGAM_AUX.DBO.VETIPOEM ROTA ON ROTA.TIPO_DE_EMPRESA = E.TIPO_DE_EMPRESA#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES R ON R.CD_EMPRESA = E.CD_CENTRALIZADO#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES TRANSP ON TRANSP.CD_EMPRESA = NOTA_ORIGINAL.CD_TRANSPORTADO#(lf)--#(lf)LEFT JOIN DADOBIER_DW.DBO.TB_ESTRUTURA_COMERCIAL_CERVEJA H ON H.CD_ROTA = E.TIPO_DE_EMPRESA#(lf)--#(lf)LEFT JOIN DADOBIER_ETL.DBO.TB_USUARIOS U ON U.CD_USUARIO = M.USU_CRIACAO#(lf)--#(lf)WHERE M.UNI_NEG = '01' AND DT_MOVIMENTO >= DATEFROMPARTS(2019,1,1) AND MAT.CD_GRUPO = '60' AND#(lf)(TP.CODIGO_NATUREZA IN (SELECT * FROM DATA_MANAGER.dbo.CFOPS_DEVOLUCOES) OR M.CD_TP_OPERACAO IN (SELECT * FROM DATA_MANAGER.dbo.TIPO_OPERACAO_DEVOLUCOES)) ", CommandTimeout=#duration(0, 0, 20, 0)]),  #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Movimento", Int64.Type}, {"EmissaoDevolucao", type date}, {"EntradaDevolucao", type date}, {"EmissaoOriginal", type date}}),  #"Rede Label" = Table.AddColumn(#"Tipo Alterado", "Rede_Label", each if [RedeRazao] is null or Text.Trim([RedeRazao]) = "" then  if [RedeFantasia] is null or Text.Trim([RedeFantasia]) = "" then "SEM REDE CADASTRADA" else Text.Combine({[Rede], " - ", [RedeFantasia]}) else Text.Combine({[Rede], " - ", [RedeRazao], " (", [RedeFantasia], ")"})),  #"Personalização Adicionada" = Table.AddColumn(#"Rede Label", "Cliente_Label", each if [ClienteRazao] is null or Text.Trim([ClienteRazao]) = "" then  if [ClienteFantasia] is null or Text.Trim([ClienteFantasia]) = ""  then "SEM REDE CADASTRADA" else Text.Combine({[Cliente], " - ", [ClienteFantasia]}) else Text.Combine({[Cliente], " - ", [ClienteRazao], " (", [ClienteFantasia], ")"})),  #"Tipo Alterado1" = Table.TransformColumnTypes(#"Personalização Adicionada",{{"Rede_Label", type text}, {"Cliente_Label", type text}}) in  #"Tipo Alterado1"|False|
|LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe||Import|Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoDevolucao])), 12, 31))|True|
|LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d||Import|Calendar(Date(Year(MIN('DEVOLUÇÕES'[EntradaDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EntradaDevolucao])), 12, 31))|True|
|LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048||Import|Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoOriginal])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoOriginal])), 12, 31))|True|
|Medidas||Import|let  Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText("i44FAA==", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#"Coluna 1" = _t]),  #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Coluna 1", type text}}),  #"Colunas Removidas" = Table.RemoveColumns(#"Tipo Alterado",{"Coluna 1"}) in  #"Colunas Removidas"|False|
|PRODUTOS||Import|let  Fonte = Sql.Database("192.168.1.249\DADOBIER_BI", "DADOBIER_ETL", [Query="SELECT#(lf)#(tab)M.CD_MATERIAL#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdProduto,#(lf)#(tab)M.DESCRICAO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Produto,#(lf)#(tab)N.NOME_MATERIAL #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Apelido,#(lf)#(tab)M.CD_UNIDADE_MEDI #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS UniMed,#(lf)#(tab)M.CD_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdGrupo,#(lf)#(tab)G.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Grupo,#(lf)#(tab)M.CD_SUB_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdSubgrupo,#(lf)#(tab)S.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Subgrupo,#(lf)#(tab)COALESCE(CG.NOME_GRUPO, 'Sem Grupo')#(tab)AS Agrupamento,#(lf)#(tab)COALESCE(CL.NOME_LINHA, 'Sem Linha')#(tab)AS Linha#(lf)FROM#(lf)#(tab)CIGAM_AUX.DBO.ESMATERI M#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESGRUPO G ON G.CD_GRUPO = M.CD_GRUPO#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESSUBGRU S ON S.CD_GRUPO = M.CD_GRUPO AND S.CD_SUB_GRUPO = M.CD_SUB_GRUPO#(lf)#(tab)LEFT JOIN DADOBIER_ETL.DBO.TB_NOMES_PERSONALIZADOS N ON N.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_PRODUTOS_LINHAS CPL ON CPL.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_LINHAS CL ON CL.ID_LINHA = CPL.ID_LINHA#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_GRUPOS CG ON CG.ID_GRUPO = CL.ID_GRUPO#(lf)WHERE#(lf)#(tab)M.CD_GRUPO = '60'#(lf)", CommandTimeout=#duration(0, 0, 20, 0)]) in  Fonte|False|
---

## Lista de Medidas:

|Measure Name|Table Name|Description|Expression|Dependency|Reverse Dependency|
|---|---|---|---|---|---|
|Quantidade|Medidas||SUM('DEVOLUÇÕES'[Quantidade])|Measure: Quantidade Table: DEVOLUÇÕES Column: Quantidade (Table: DEVOLUÇÕES) Table: DEVOLUÇÕES ... Column: Quantidade (Table: DEVOLUÇÕES) ...|Measure: Quantidade Measure: Quantidade Measure: Quantidade ...|
|Volume|Medidas||SUM('DEVOLUÇÕES'[Volume])|Measure: Volume Table: DEVOLUÇÕES Column: Volume (Table: DEVOLUÇÕES) Table: DEVOLUÇÕES ... Column: Volume (Table: DEVOLUÇÕES) ...|Measure: Volume Measure: Volume Measure: Volume ...|
|PrecoTotal|Medidas||sum('DEVOLUÇÕES'[PrecoTotal])|Measure: PrecoTotal Table: DEVOLUÇÕES Column: PrecoTotal (Table: DEVOLUÇÕES) Table: DEVOLUÇÕES ... Column: PrecoTotal (Table: DEVOLUÇÕES) ...|Measure: PrecoTotal Measure: PrecoTotal Measure: PrecoTotal ...|
---

## Lista de Colunas por tabela:

### Lista de colunas na tabela DEVOLUÇÕES:

|Column Name|Description|Calculated Column|Expression|
|---|---|---|---|
|CFOP||||
|Movimento||||
|TipoOperacao||||
|DescCFOP||||
|Cliente||||
|ClienteRazao||||
|ClienteFantasia||||
|ClienteUF|Estado da criatura|||
|ClienteMunicipio||||
|CdRota||||
|NomeRota||||
|Rede||||
|RedeRazao||||
|RedeFantasia||||
|SerieDevolucao||||
|NFDevolucao||||
|EmissaoDevolucao||||
|EntradaDevolucao||||
|Usuario||||
|CdUsuario||||
|NomeUsuario||||
|CodProduto||||
|DescProduto||||
|MotivoDevolucao||||
|TipoIndenizacao||||
|NfOriginal||||
|SerieOriginal||||
|EmissaoOriginal||||
|ChaveNfOriginal||||
|Supervisor||||
|Vendedor||||
|Canal||||
|CdTransportadora||||
|RazaoTransportadora||||
|FantasiaTransportadora||||
|CNPJTransportadora||||
|Quantidade||||
|Volume||||
|PrecoTotal||||
|IPI||||
|ICMS||||
|TipoDevolucao||||
|Rede_Label||||
|Cliente_Label||||
### Lista de colunas na tabela Medidas:

|Column Name|Description|Calculated Column|Expression|
|---|---|---|---|
### Lista de colunas na tabela PRODUTOS:

|Column Name|Description|Calculated Column|Expression|
|---|---|---|---|
|CdProduto||||
|Produto||||
|Apelido||||
|UniMed||||
|CdGrupo||||
|Grupo||||
|CdSubgrupo||||
|Subgrupo||||
|Agrupamento||||
|Linha||||
---

## Lista de Funções (Roles):

|Role Name|Table Name|Description|Expression|
|---|---|---|---|
---

## Lista de Relacionamentos:

|Name|CrossFilteringBehavior|FromCardinality|FromColumn|FromTable|IsActive|IsRemoved|JoinOnDateBehavior|RelyOnReferentialIntegrity|SecurityFilteringBehavior|State|ToCardinality|ToColumn|ToTable|Type|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|515e96fe-8e39-4138-9193-0495feab1429|OneDirection|Many|EmissaoDevolucao|DEVOLUÇÕES|True|False|DatePartOnly|False|OneDirection|Ready|One|Date|LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe|SingleColumn|
|2e214fd4-7020-4cea-afdb-e41ddb94370d|OneDirection|Many|EntradaDevolucao|DEVOLUÇÕES|True|False|DatePartOnly|False|OneDirection|Ready|One|Date|LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d|SingleColumn|
|459152bf-fa19-45bb-af29-84f69e7846c6|OneDirection|Many|EmissaoOriginal|DEVOLUÇÕES|True|False|DatePartOnly|False|OneDirection|Ready|One|Date|LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048|SingleColumn|
|6c088134-2714-4890-aece-e1a86a834bdf|OneDirection|Many|CodProduto|DEVOLUÇÕES|True|False|DateAndTime|False|OneDirection|Ready|One|CdProduto|PRODUTOS|SingleColumn|
---

## Power Query:

### DateTableTemplate_56af38da-5a48-4aa0-89f3-22215533f47c-f2c431bf-9700-4f48-9bfe-988e99e967d4:

>Calendar(Date(2015,1,1), Date(2015,1,1))

### DEVOLUÇÕES-97f4a9e8-0a35-4747-a05d-ba1a93e1ac91:

>let
>
>Fonte = Sql.Database("192.168.1.249\DADOBIER_BI", "DADOBIER_ETL", [Query="--CREATE VIEW [dbo].[RELATORIO_DEVOLUCOES] AS#(lf)SELECT#(lf)    -- Dados categoricos#(lf)--#(lf)    -- Dados base#(lf)#(tab)M.MOVIMENTO                                                                                         AS Movimento,#(lf)#(tab)M.CFOP                                                                                              AS CFOP,#(lf)#(tab)M.CD_TP_OPERACAO                                                                                    AS TipoOperacao,#(lf)#(tab)TP.DESCRICAO                                                                                        AS DescCFOP,#(lf)--#(lf)    -- Dados Cliente#(lf)#(tab)E.CD_EMPRESA                                                                                        AS Cliente,#(lf)#(tab)E.NOME_COMPLETO                                                                                     AS ClienteRazao,#(lf)#(tab)E.FANTASIA                                                                                          AS ClienteFantasia,#(lf)#(tab)E.UF                                                                                                AS ClienteUF,#(lf)#(tab)E.MUNICIPIO                                                                                         AS ClienteMunicipio,#(lf)#(tab)ISNULL(E.TIPO_DE_EMPRESA, '00')                                                                     AS CdRota,#(lf)#(tab)ISNULL(ROTA.DESCRICAO, 'SEM ROTA DEFINIDA')                                                         AS NomeRota,#(lf)#(tab)ISNULL(R.CD_EMPRESA , E.CD_EMPRESA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Rede,#(lf)#(tab)CASE WHEN TRIM(ISNULL(R.NOME_COMPLETO, '')) = '' THEN E.NOME_COMPLETO ELSE R.NOME_COMPLETO END      AS RedeRazao,#(lf)#(tab)ISNULL(R.FANTASIA , E.FANTASIA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS RedeFantasia,#(lf)--#(lf)    -- Dados nota#(lf)#(tab)M.SERIE                                                                                             AS SerieDevolucao, #(lf)    M.NF                                                                                                AS NFDevolucao,#(lf)#(tab)ENT.DT_EMISSAO                                                                                      AS EmissaoDevolucao,#(lf)#(tab)M.DT_MOVIMENTO                                                                                      AS EntradaDevolucao,#(lf)#(tab)U.USUARIO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Usuario,#(lf)#(tab)M.USU_CRIACAO                                                                                       AS CdUsuario,#(lf)#(tab)U.NOME#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS NomeUsuario,#(lf)--#(lf)    -- Dados de produto#(lf)#(tab)MAT.CD_MATERIAL                                                                              #(tab)#(tab)AS CodProduto,#(lf)#(tab)MAT.DESCRICAO                                                                                       AS DescProduto,#(lf)--#(lf)    -- Dados devolucao#(lf)    CASE WHEN TRIM(ISNULL(D.DESCRICAO, '')) = '' THEN 'SEM MOTIVO INFORMADO' ELSE D.DESCRICAO END#(tab)#(tab)AS MotivoDevolucao,#(lf)#(tab)CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END   AS TipoIndenizacao,#(lf)#(tab)CASE#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'P' THEN 'RETORNO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'N' THEN 'NÃO INDENIZADO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'V' THEN 'INDENIZADO'#(lf)#(tab)#(tab)ELSE 'NÃO ENCONTRADO'#(lf)#(tab)END #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS TipoDevolucao,#(lf)--#(lf)#(tab)-- Dados NF referencia#(lf)    ENT.NF_REFERENCIA                                                                                   AS NfOriginal,#(lf)#(tab)ENT.SERIE_REFERENCI                                                                                 AS SerieOriginal,#(lf)#(tab)NOTA_ORIGINAL.DT_EMISSAO                                                                            AS EmissaoOriginal,#(lf)#(tab)CONCAT(FORMAT(ENT.NF_REFERENCIA, '0000000000'), '.', ENT.SERIE_REFERENCI)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS ChaveNfOriginal,#(lf)--#(lf)    -- Dados responsabilidade#(lf)#(tab)ISNULL(H.SUPERVISOR, 'SEM SUPERVISOR DEFINIDO')                                                   #(tab)AS Supervisor,#(lf)#(tab)ISNULL(H.VENDEDOR, 'SEM VENDEDOR DEFINIDO')                                                     #(tab)AS Vendedor,#(lf)#(tab)CASE #(tab)#(lf)#(tab)#(tab)WHEN H.CANAL IS NULL AND E.UF = 'EX' THEN 'EXPORTAÇÃO'#(lf)#(tab)#(tab)ELSE ISNULL(H.CANAL, 'SEM CANAL DEFINIDO')#(lf)#(tab)END#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Canal,#(lf)--#(lf)    -- Dados Transportadora da nota original#(lf)    TRANSP.CD_EMPRESA                                                                                   AS CdTransportadora,#(lf)#(tab)TRANSP.NOME_COMPLETO                                                                                AS RazaoTransportadora,#(lf)#(tab)TRANSP.FANTASIA                                                                                     AS FantasiaTransportadora,#(lf)#(tab)TRANSP.CNPJ_CPF                                                                                     AS CNPJTransportadora,#(lf)--#(lf)    -- Dados Numericos#(lf)#(tab)M.QUANTIDADE                                                                                        AS Quantidade,#(lf)#(tab)CASE WHEN M.UNI_MED = 'UN' THEN MAT.PESO ELSE 1 END * M.QUANTIDADE                                  AS Volume,#(lf)#(tab)M.PR_TOTAL_ITEM + M.VL_DESCONTO + M.TOTAL_DESP_ITEM + M.VL_IPI + M.VL_SUBSTITUICAO                  AS PrecoTotal,#(lf)#(tab)M.VL_IPI                                                                                            AS IPI,#(lf)#(tab)M.VL_ICMS                                                                                           AS ICMS#(lf)--#(lf)FROM CIGAM_RAW_DATA.dbo.ESMOVIME M#(lf)LEFT JOIN CIGAM_AUX.dbo.GETOPERA TP ON TP.CD_TIPO_OPERACA = M.CD_TP_OPERACAO#(lf)LEFT JOIN CIGAM_AUX.dbo.ESMATERI MAT ON MAT.CD_MATERIAL = M.CD_MATERIAL#(lf)LEFT JOIN CIGAM_CORE.dbo.COENTRAD ENT ON ENT.NF = M.NF AND ENT.SERIE = M.SERIE AND ENT.CD_FORNECEDOR  = M.CD_EMPRESA AND ENT.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN DADOBIER_DW.dbo.TB_MOTIVOS_DEVOLUCAO D ON D.MOVIMENTO = M.MOVIMENTO#(lf)--#(lf)LEFT JOIN CIGAM_CORE.dbo.FANFISCA NOTA_ORIGINAL ON NOTA_ORIGINAL.NF = ENT.NF_REFERENCIA AND NOTA_ORIGINAL.SERIE = 'NFE' AND NOTA_ORIGINAL.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES E ON E.CD_EMPRESA = CASE WHEN M.CD_EMPRESA = '000001' THEN NOTA_ORIGINAL.CD_CLIENTE ELSE M.CD_EMPRESA END#(lf)LEFT JOIN CIGAM_AUX.DBO.VETIPOEM ROTA ON ROTA.TIPO_DE_EMPRESA = E.TIPO_DE_EMPRESA#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES R ON R.CD_EMPRESA = E.CD_CENTRALIZADO#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES TRANSP ON TRANSP.CD_EMPRESA =  NOTA_ORIGINAL.CD_TRANSPORTADO#(lf)--#(lf)LEFT JOIN DADOBIER_DW.DBO.TB_ESTRUTURA_COMERCIAL_CERVEJA H ON H.CD_ROTA = E.TIPO_DE_EMPRESA#(lf)--#(lf)LEFT JOIN DADOBIER_ETL.DBO.TB_USUARIOS U ON U.CD_USUARIO = M.USU_CRIACAO#(lf)--#(lf)WHERE M.UNI_NEG = '01' AND DT_MOVIMENTO >= DATEFROMPARTS(2019,1,1) AND MAT.CD_GRUPO = '60' AND#(lf)(TP.CODIGO_NATUREZA IN (SELECT * FROM DATA_MANAGER.dbo.CFOPS_DEVOLUCOES) OR M.CD_TP_OPERACAO IN (SELECT * FROM DATA_MANAGER.dbo.TIPO_OPERACAO_DEVOLUCOES)) ", CommandTimeout=#duration(0, 0, 20, 0)]),
>
>#"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Movimento", Int64.Type}, {"EmissaoDevolucao", type date}, {"EntradaDevolucao", type date}, {"EmissaoOriginal", type date}}),
>
>#"Rede Label" = Table.AddColumn(#"Tipo Alterado", "Rede_Label", each if [RedeRazao] is null or Text.Trim([RedeRazao]) = "" then
>
>if [RedeFantasia] is null or Text.Trim([RedeFantasia]) = ""
>
>then "SEM REDE CADASTRADA"
>
>else Text.Combine({[Rede], " - ", [RedeFantasia]})
>
>else Text.Combine({[Rede], " - ", [RedeRazao], " (", [RedeFantasia], ")"})),
>
>#"Personalização Adicionada" = Table.AddColumn(#"Rede Label", "Cliente_Label", each if [ClienteRazao] is null or Text.Trim([ClienteRazao]) = ""
>
>then
>
>if [ClienteFantasia] is null or Text.Trim([ClienteFantasia]) = ""
>
>then "SEM REDE CADASTRADA"
>
>else Text.Combine({[Cliente], " - ", [ClienteFantasia]})
>
>else Text.Combine({[Cliente], " - ", [ClienteRazao], " (", [ClienteFantasia], ")"})),
>
>#"Tipo Alterado1" = Table.TransformColumnTypes(#"Personalização Adicionada",{{"Rede_Label", type text}, {"Cliente_Label", type text}})
>
>in
>
>#"Tipo Alterado1"

### LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe-e006dac6-8c02-4507-a2f3-7775c3b75d96:

>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoDevolucao])), 12, 31))

### LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d-08a1c732-d407-489f-a29d-525b764945fd:

>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EntradaDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EntradaDevolucao])), 12, 31))

### LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048-7ccd131f-93f6-456b-a074-b49369906417:

>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoOriginal])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoOriginal])), 12, 31))

### Medidas-87538b6d-6a4f-4334-b2b0-5b439723f2bc:

>let
>
>Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText("i44FAA==", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#"Coluna 1" = _t]),
>
>#"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Coluna 1", type text}}),
>
>#"Colunas Removidas" = Table.RemoveColumns(#"Tipo Alterado",{"Coluna 1"})
>
>in
>
>#"Colunas Removidas"

### PRODUTOS-7d537543-2a7c-4653-aca3-14c2e63b8441:

>let
>
>Fonte = Sql.Database("192.168.1.249\DADOBIER_BI", "DADOBIER_ETL", [Query="SELECT#(lf)#(tab)M.CD_MATERIAL#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdProduto,#(lf)#(tab)M.DESCRICAO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Produto,#(lf)#(tab)N.NOME_MATERIAL #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Apelido,#(lf)#(tab)M.CD_UNIDADE_MEDI #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS UniMed,#(lf)#(tab)M.CD_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdGrupo,#(lf)#(tab)G.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Grupo,#(lf)#(tab)M.CD_SUB_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdSubgrupo,#(lf)#(tab)S.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Subgrupo,#(lf)#(tab)COALESCE(CG.NOME_GRUPO, 'Sem Grupo')#(tab)AS Agrupamento,#(lf)#(tab)COALESCE(CL.NOME_LINHA, 'Sem Linha')#(tab)AS Linha#(lf)FROM#(lf)#(tab)CIGAM_AUX.DBO.ESMATERI M#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESGRUPO G ON G.CD_GRUPO = M.CD_GRUPO#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESSUBGRU S ON S.CD_GRUPO = M.CD_GRUPO AND S.CD_SUB_GRUPO = M.CD_SUB_GRUPO#(lf)#(tab)LEFT JOIN DADOBIER_ETL.DBO.TB_NOMES_PERSONALIZADOS N ON N.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_PRODUTOS_LINHAS CPL ON CPL.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_LINHAS CL ON CL.ID_LINHA = CPL.ID_LINHA#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_GRUPOS CG ON CG.ID_GRUPO = CL.ID_GRUPO#(lf)WHERE#(lf)#(tab)M.CD_GRUPO = '60'#(lf)", CommandTimeout=#duration(0, 0, 20, 0)])
>
>in
>
>Fonte

