<html><style>body {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
h1, h2, h3, h4, h5, h6 {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
table, pre {
color: #000000;
background-color: #FFFFFF;
font-size: 16;
font-family: Serif;
font-weight: normal;
font-style: normal;
}

ul, #myUL {
  list-style-type: none;
}

#myUL {
  margin: 0;
  padding: 0;
}

.caret, .dropDownCaret {
  cursor: pointer;
}

.caret::before {
	content: "\25B6";
	color: black;
	display: inline - block;
	margin - right: 6px;
}

.dropDownCaret::before {
	content: "\25BC";
	color: black;
	display: inline - block;
	margin - right: 6px;
	float: right;
}


.nested {
  display: none;
}

.active {
  display: block;
}
</style><body><br></br><h1><div>Power BI Documentation</div></h1><br></br><hr></hr><h2><div>Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright &copy; <a href="http://radacad.com">RADACAD</a>).</div><br></br><div>Date: 05/11/2022 22:10:59</div><br></br></h2><h1><div>------------------******   Visualization    ******---------------------</div></h1><br></br><h2><div>File: Devoluções.pbix</div></h2><br></br><h3><div>Path: I:\03.DADOPAR\ADMINISTRATIVO\BI\VAGNER\POWER BI\ONLINE\COMERCIAL OPERACIONAL\DEVOLUCOES\Devoluções.pbix</div></h2><br></br><hr></hr><br></br><h3><div>List of Pages:</div></h3><br></br><table border='1px' cellpadding='1'><tr ><td >DisplayName</td><td >Name</td><td >Ordinal</td><td >DisplayOption</td><td >Width</td><td >Height</td><td >PageIndex</td></tr><tr ><td >Home</td><td >ReportSectionf006ae245620d788e624</td><td >0</td><td >1</td><td >1920</td><td >1080</td><td >0</td></tr><tr ><td >Relatório</td><td >ReportSectiona2845233991e3e9977b4</td><td >1</td><td >1</td><td >1920</td><td >1080</td><td >1</td></tr></table><hr></hr><br></br><h3><div>Visuals in Home:</div></h3><table border='1px' cellpadding='1'><tr ><td >Visual Type</td><td >Title</td><td >X</td><td >Y</td><td >Z</td><td >Width</td><td >Height</td><td >Name</td><td >tabOrder</td><td >VisualIndex</td><td >PageIndex</td></tr><tr ><td >image</td><td ></td><td >0</td><td >0</td><td >3000</td><td >178,83149872989</td><td >149,56816257409</td><td >7372684b749e6794e9a0</td><td ></td><td >0</td><td >0</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Canal'</td><td >0</td><td >210,510396975425</td><td >6000</td><td >282,878916172735</td><td >89,415749364945</td><td >4e83e5b882a779576eee</td><td >3000</td><td >1</td><td >0</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'UF'</td><td >283</td><td >210,510396975425</td><td >9000</td><td >239</td><td >88</td><td >37efd240112ee6b4043e</td><td >6000</td><td >2</td><td >0</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Tipo de devolução'</td><td >522</td><td >210,510396975425</td><td >10000</td><td >343</td><td >88</td><td >4810aa3de605120913b9</td><td >9000</td><td >3</td><td >0</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Ano'</td><td >1160</td><td >210,510396975425</td><td >11000</td><td >243</td><td >88</td><td >df72b1426e2ddadb19d8</td><td >10000</td><td >4</td><td >0</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Mês'</td><td >1402,797731569</td><td >210,510396975425</td><td >12000</td><td >517,202268431002</td><td >87,1077504725898</td><td >345e5de08651723c35ce</td><td >11000</td><td >5</td><td >0</td></tr><tr ><td >textbox</td><td ></td><td >432,447078746825</td><td >16,2574089754445</td><td >13000</td><td >1055,10584250635</td><td >133,310753598645</td><td >79a256f0555246518ee5</td><td >12000</td><td >6</td><td >0</td></tr><tr ><td >pivotTable</td><td ></td><td >597,299035369775</td><td >344,180064308682</td><td >14000</td><td >723,858520900322</td><td >720,771704180064</td><td >53f9af3d185780c90797</td><td >13000</td><td >7</td><td >0</td></tr><tr ><td >shape</td><td ></td><td >0</td><td >136,105860113422</td><td >0</td><td >1920</td><td >96,1814744801512</td><td >c5cae3e63809eb1485d9</td><td >14000</td><td >8</td><td >0</td></tr><tr ><td >actionButton</td><td ></td><td >1721,3349230713</td><td >82,34567925405</td><td >7000</td><td >170,928626247122</td><td >57,4673829623945</td><td >ac4e74c89a272f70c045</td><td >7000</td><td >9</td><td >0</td></tr><tr ><td >textbox</td><td ></td><td >1721,39107292956</td><td >85,5946768576963</td><td >4000</td><td >170,816326530612</td><td >50,969387755102</td><td >0787dcfcc690992f1775</td><td >4000</td><td >10</td><td >0</td></tr><tr ><td >shape</td><td ></td><td >1721,3349230713</td><td >82,34567925405</td><td >1000</td><td >170,928626247122</td><td >57,4673829623945</td><td >707b11554cfe9f8555ca</td><td >1000</td><td >11</td><td >0</td></tr><tr ><td >actionButton</td><td ></td><td >1721,13945578231</td><td >4,25170068027211</td><td >8000</td><td >170,816326530612</td><td >56,4795918367347</td><td >e4a7332ee6c14a9d5c52</td><td >8000</td><td >12</td><td >0</td></tr><tr ><td >textbox</td><td ></td><td >1721,13945578231</td><td >7,00680272108844</td><td >5000</td><td >170,816326530612</td><td >50,969387755102</td><td >1f237578a07fb723d127</td><td >5000</td><td >13</td><td >0</td></tr><tr ><td >shape</td><td ></td><td >1721,13945578231</td><td >4,25170068027211</td><td >2000</td><td >170,816326530612</td><td >56,4795918367347</td><td >3a456f7d454ab54dbaab</td><td >2000</td><td >14</td><td >0</td></tr><tr ><td >pivotTable</td><td ></td><td >1350,48231511254</td><td >344,180064308682</td><td >15000</td><td >561,800643086817</td><td >720,771704180064</td><td >c1e61bf15dd6f0f8a73b</td><td >15000</td><td >15</td><td >0</td></tr><tr ><td >pivotTable</td><td ></td><td >0</td><td >344,180064308682</td><td >16000</td><td >583,408360128617</td><td >720,771704180064</td><td >b18aee31a9fe77f99877</td><td >16000</td><td >16</td><td >0</td></tr></table><br></br><h3><div>Visuals in Relatório:</div></h3><table border='1px' cellpadding='1'><tr ><td >Visual Type</td><td >Title</td><td >X</td><td >Y</td><td >Z</td><td >Width</td><td >Height</td><td >Name</td><td >tabOrder</td><td >VisualIndex</td><td >PageIndex</td></tr><tr ><td >image</td><td ></td><td >0</td><td >0</td><td >3000</td><td >178,83149872989</td><td >149,56816257409</td><td >f3c7cb5da0b360834180</td><td ></td><td >0</td><td >1</td></tr><tr ><td >shape</td><td ></td><td >1717,80612244898</td><td >0</td><td >0</td><td >170,816326530612</td><td >56,4795918367347</td><td >5fc1d20717514e7dc1ac</td><td >6000</td><td >1</td><td >1</td></tr><tr ><td >textbox</td><td ></td><td >1717,80612244898</td><td >5,51020408163265</td><td >4000</td><td >170,816326530612</td><td >50,969387755102</td><td >783149ec03d257193a8c</td><td >1000</td><td >2</td><td >1</td></tr><tr ><td >actionButton</td><td ></td><td >1717,80612244898</td><td >0</td><td >6000</td><td >170,816326530612</td><td >56,4795918367347</td><td >57778428d48d27bce478</td><td >3000</td><td >3</td><td >1</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Canal'</td><td >0</td><td >212,325141776938</td><td >7000</td><td >282,878916172735</td><td >89,415749364945</td><td >3eec4430b8be50aee3d0</td><td >4000</td><td >4</td><td >1</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'UF'</td><td >283</td><td >212,325141776938</td><td >9000</td><td >239</td><td >88</td><td >9c4872d095ed4450a7b0</td><td >7000</td><td >5</td><td >1</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Tipo de devolução'</td><td >522</td><td >212,325141776938</td><td >10000</td><td >343</td><td >88</td><td >734deacd23a0a7557548</td><td >9000</td><td >6</td><td >1</td></tr><tr ><td >tableEx</td><td ></td><td >9,07372400756144</td><td >342,986767485822</td><td >11000</td><td >1900,03780718336</td><td >736,786389413989</td><td >2511e9b012d05655a3a7</td><td >10000</td><td >7</td><td >1</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Ano'</td><td >1160</td><td >212,325141776938</td><td >12000</td><td >243</td><td >88</td><td >b8a5598a320ab27410d0</td><td >11000</td><td >8</td><td >1</td></tr><tr ><td >ChicletSlicer1448559807354</td><td >'Mês'</td><td >1402,797731569</td><td >212,325141776938</td><td >13000</td><td >517,202268431002</td><td >87,1077504725898</td><td >9c7a895341a2abdbb34e</td><td >12000</td><td >9</td><td >1</td></tr><tr ><td >textbox</td><td ></td><td >432,447078746825</td><td >16,2574089754445</td><td >14000</td><td >1055,10584250635</td><td >133,310753598645</td><td >21ad119a4d0d9aa91665</td><td >13000</td><td >10</td><td >1</td></tr><tr ><td >shape</td><td ></td><td >1718,00158973797</td><td >79,0123459207167</td><td >1000</td><td >170,928626247122</td><td >57,4673829623945</td><td >ab8b35d0173014e68396</td><td >8000</td><td >11</td><td >1</td></tr><tr ><td >textbox</td><td ></td><td >1718,05773959622</td><td >82,2613435243629</td><td >5000</td><td >170,816326530612</td><td >50,969387755102</td><td >d5aa4e2a5081a45e1c54</td><td >5000</td><td >12</td><td >1</td></tr><tr ><td >actionButton</td><td ></td><td >1718,00158973797</td><td >79,0123459207167</td><td >8000</td><td >170,928626247122</td><td >57,4673829623945</td><td >f38fbd121a563ccc18a7</td><td >2000</td><td >13</td><td >1</td></tr><tr ><td >shape</td><td ></td><td >0</td><td >136,105860113422</td><td >2000</td><td >1920</td><td >96,1814744801512</td><td >27f55178e74399b0995c</td><td >14000</td><td >14</td><td >1</td></tr></table><hr></hr><br></br><h3><div>List of Bookmarks:</div></h3><br></br><table border='1px' cellpadding='1'><tr ><td >DisplayName</td><td >Page Name</td><td >Index</td><td >Name</td></tr><tr ><td >Home</td><td >ReportSectionf006ae245620d788e624</td><td >0</td><td >Bookmark9f752631a8a406e38a7d</td></tr><tr ><td >Relatório</td><td >ReportSectiona2845233991e3e9977b4</td><td >1</td><td >Bookmark383fe03d1e42cc9c2786</td></tr></table><hr></hr><br></br><h3><div>List of all Columns/Fields/Measures/Expressions Used in Visuals:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Table Name</td><td >Aggregation</td><td >Expression</td><td >VisualIndex</td><td >PageIndex</td></tr><tr ><td >Canal</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Canal</td><td >1</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >1</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >2</td><td >0</td></tr><tr ><td >ClienteUF</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.ClienteUF</td><td >2</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >3</td><td >0</td></tr><tr ><td >TipoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.TipoDevolucao</td><td >3</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >4</td><td >0</td></tr><tr ><td >Ano</td><td ></td><td ></td><td >DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Ano</td><td >4</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >5</td><td >0</td></tr><tr ><td >Mês</td><td ></td><td ></td><td >DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Mês</td><td >5</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >7</td><td >0</td></tr><tr ><td >PrecoTotal</td><td >Medidas</td><td ></td><td >Medidas.PrecoTotal</td><td >7</td><td >0</td></tr><tr ><td >Rede_Label</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Rede_Label</td><td >7</td><td >0</td></tr><tr ><td >Cliente_Label</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Cliente_Label</td><td >7</td><td >0</td></tr><tr ><td >NFDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.NFDevolucao</td><td >7</td><td >0</td></tr><tr ><td >Rede_Label</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Rede_Label</td><td >7</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >15</td><td >0</td></tr><tr ><td >PrecoTotal</td><td >Medidas</td><td ></td><td >Medidas.PrecoTotal</td><td >15</td><td >0</td></tr><tr ><td >Linha</td><td >PRODUTOS</td><td ></td><td >PRODUTOS.Linha</td><td >15</td><td >0</td></tr><tr ><td >Produto</td><td >PRODUTOS</td><td ></td><td >PRODUTOS.Produto</td><td >15</td><td >0</td></tr><tr ><td >Produto</td><td >PRODUTOS</td><td ></td><td >PRODUTOS.Produto</td><td >15</td><td >0</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >16</td><td >0</td></tr><tr ><td >PrecoTotal</td><td >Medidas</td><td ></td><td >Medidas.PrecoTotal</td><td >16</td><td >0</td></tr><tr ><td >TipoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.TipoDevolucao</td><td >16</td><td >0</td></tr><tr ><td >MotivoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.MotivoDevolucao</td><td >16</td><td >0</td></tr><tr ><td >MotivoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.MotivoDevolucao</td><td >16</td><td >0</td></tr><tr ><td >Canal</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Canal</td><td >4</td><td >1</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >4</td><td >1</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >5</td><td >1</td></tr><tr ><td >ClienteUF</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.ClienteUF</td><td >5</td><td >1</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >6</td><td >1</td></tr><tr ><td >TipoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.TipoDevolucao</td><td >6</td><td >1</td></tr><tr ><td >EntradaDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.EntradaDevolucao</td><td >7</td><td >1</td></tr><tr ><td >EmissaoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.EmissaoDevolucao</td><td >7</td><td >1</td></tr><tr ><td >MotivoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.MotivoDevolucao</td><td >7</td><td >1</td></tr><tr ><td >TipoDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.TipoDevolucao</td><td >7</td><td >1</td></tr><tr ><td >TipoOperacao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.TipoOperacao</td><td >7</td><td >1</td></tr><tr ><td >DescCFOP</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.DescCFOP</td><td >7</td><td >1</td></tr><tr ><td >Cliente</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Cliente</td><td >7</td><td >1</td></tr><tr ><td >ClienteFantasia</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.ClienteFantasia</td><td >7</td><td >1</td></tr><tr ><td >ClienteRazao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.ClienteRazao</td><td >7</td><td >1</td></tr><tr ><td >ClienteUF</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.ClienteUF</td><td >7</td><td >1</td></tr><tr ><td >ClienteMunicipio</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.ClienteMunicipio</td><td >7</td><td >1</td></tr><tr ><td >Rede</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Rede</td><td >7</td><td >1</td></tr><tr ><td >RedeFantasia</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.RedeFantasia</td><td >7</td><td >1</td></tr><tr ><td >RedeRazao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.RedeRazao</td><td >7</td><td >1</td></tr><tr ><td >NomeRota</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.NomeRota</td><td >7</td><td >1</td></tr><tr ><td >Canal</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Canal</td><td >7</td><td >1</td></tr><tr ><td >Supervisor</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Supervisor</td><td >7</td><td >1</td></tr><tr ><td >Vendedor</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.Vendedor</td><td >7</td><td >1</td></tr><tr ><td >SerieDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.SerieDevolucao</td><td >7</td><td >1</td></tr><tr ><td >NFDevolucao</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.NFDevolucao</td><td >7</td><td >1</td></tr><tr ><td >EmissaoOriginal</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.EmissaoOriginal</td><td >7</td><td >1</td></tr><tr ><td >SerieOriginal</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.SerieOriginal</td><td >7</td><td >1</td></tr><tr ><td >NfOriginal</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.NfOriginal</td><td >7</td><td >1</td></tr><tr ><td >CdTransportadora</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.CdTransportadora</td><td >7</td><td >1</td></tr><tr ><td >FantasiaTransportadora</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.FantasiaTransportadora</td><td >7</td><td >1</td></tr><tr ><td >Linha</td><td >PRODUTOS</td><td ></td><td >PRODUTOS.Linha</td><td >7</td><td >1</td></tr><tr ><td >CodProduto</td><td >DEVOLUÇÕES</td><td ></td><td >DEVOLUÇÕES.CodProduto</td><td >7</td><td >1</td></tr><tr ><td >Produto</td><td >PRODUTOS</td><td ></td><td >PRODUTOS.Produto</td><td >7</td><td >1</td></tr><tr ><td >Apelido</td><td >PRODUTOS</td><td ></td><td >PRODUTOS.Apelido</td><td >7</td><td >1</td></tr><tr ><td >Quantidade</td><td >DEVOLUÇÕES</td><td >Sum</td><td >Sum(DEVOLUÇÕES.Quantidade)</td><td >7</td><td >1</td></tr><tr ><td >Volume</td><td >DEVOLUÇÕES</td><td >Sum</td><td >Sum(DEVOLUÇÕES.Volume)</td><td >7</td><td >1</td></tr><tr ><td >PrecoTotal</td><td >DEVOLUÇÕES</td><td >Sum</td><td >Sum(DEVOLUÇÕES.PrecoTotal)</td><td >7</td><td >1</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >8</td><td >1</td></tr><tr ><td >Ano</td><td ></td><td ></td><td >DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Ano</td><td >8</td><td >1</td></tr><tr ><td >Volume</td><td >Medidas</td><td ></td><td >Medidas.Volume</td><td >9</td><td >1</td></tr><tr ><td >Mês</td><td ></td><td ></td><td >DEVOLUÇÕES.EntradaDevolucao.Variation.Hierarquia de datas.Mês</td><td >9</td><td >1</td></tr></table><hr></hr><br></br><h3><div>List of Tables Used in Visuals:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td></tr><tr ><td >DEVOLUÇÕES</td></tr><tr ><td >Medidas</td></tr><tr ><td >LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d</td></tr><tr ><td >PRODUTOS</td></tr></table><hr></hr><br></br><h3><div>List of Columns Not Used in Visuals:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Table Name</td><td >State</td><td >Data Category</td><td >Data Type</td><td >Description</td><td >Display Folder</td><td >Error Message</td><td >Format String</td><td >Is Hidden</td><td >Modified Time</td><td >Structure Modified Time</td><td >Sort by Column</td><td >Summarize By</td><td >Type</td><td >Expression</td></tr><tr ><td >CFOP</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >Movimento</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >CdRota</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >Usuario</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >CdUsuario</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >NomeUsuario</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >DescProduto</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >TipoIndenizacao</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >ChaveNfOriginal</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >RazaoTransportadora</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >CNPJTransportadora</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >IPI</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >ICMS</td><td >DEVOLUÇÕES</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >CdProduto</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >UniMed</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >CdGrupo</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >Grupo</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >CdSubgrupo</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >Subgrupo</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >Agrupamento</td><td >PRODUTOS</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >COLUMN</td><td ></td></tr><tr ><td >Quantidade</td><td >Medidas</td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td ></td><td >MEASURE</td><td ></td></tr></table><h1><div>------------------******   Model    ******---------------------</div></h1><br></br><h2><div>Model: Devoluções</div></h2><br></br><hr></hr><br></br><h3><div>List of Tables:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Description</td><td >Storage Mode</td><td >Source</td><td >Is Hidden</td></tr><tr ><td >DateTableTemplate_56af38da-5a48-4aa0-89f3-22215533f47c</td><td ></td><td >Import</td><td ><pre>Calendar(Date(2015,1,1), Date(2015,1,1))</pre></td><td >True</td></tr><tr ><td >DEVOLUÇÕES</td><td >Desc</td><td >Import</td><td ><pre>let
    Fonte = Sql.Database("192.168.1.249\DADOBIER_BI", "DADOBIER_ETL", [Query="--CREATE VIEW [dbo].[RELATORIO_DEVOLUCOES] AS#(lf)SELECT#(lf)    -- Dados categoricos#(lf)--#(lf)    -- Dados base#(lf)#(tab)M.MOVIMENTO                                                                                         AS Movimento,#(lf)#(tab)M.CFOP                                                                                              AS CFOP,#(lf)#(tab)M.CD_TP_OPERACAO                                                                                    AS TipoOperacao,#(lf)#(tab)TP.DESCRICAO                                                                                        AS DescCFOP,#(lf)--#(lf)    -- Dados Cliente#(lf)#(tab)E.CD_EMPRESA                                                                                        AS Cliente,#(lf)#(tab)E.NOME_COMPLETO                                                                                     AS ClienteRazao,#(lf)#(tab)E.FANTASIA                                                                                          AS ClienteFantasia,#(lf)#(tab)E.UF                                                                                                AS ClienteUF,#(lf)#(tab)E.MUNICIPIO                                                                                         AS ClienteMunicipio,#(lf)#(tab)ISNULL(E.TIPO_DE_EMPRESA, '00')                                                                     AS CdRota,#(lf)#(tab)ISNULL(ROTA.DESCRICAO, 'SEM ROTA DEFINIDA')                                                         AS NomeRota,#(lf)#(tab)ISNULL(R.CD_EMPRESA , E.CD_EMPRESA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Rede,#(lf)#(tab)CASE WHEN TRIM(ISNULL(R.NOME_COMPLETO, '')) = '' THEN E.NOME_COMPLETO ELSE R.NOME_COMPLETO END      AS RedeRazao,#(lf)#(tab)ISNULL(R.FANTASIA , E.FANTASIA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS RedeFantasia,#(lf)--#(lf)    -- Dados nota#(lf)#(tab)M.SERIE                                                                                             AS SerieDevolucao, #(lf)    M.NF                                                                                                AS NFDevolucao,#(lf)#(tab)ENT.DT_EMISSAO                                                                                      AS EmissaoDevolucao,#(lf)#(tab)M.DT_MOVIMENTO                                                                                      AS EntradaDevolucao,#(lf)#(tab)U.USUARIO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Usuario,#(lf)#(tab)M.USU_CRIACAO                                                                                       AS CdUsuario,#(lf)#(tab)U.NOME#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS NomeUsuario,#(lf)--#(lf)    -- Dados de produto#(lf)#(tab)MAT.CD_MATERIAL                                                                              #(tab)#(tab)AS CodProduto,#(lf)#(tab)MAT.DESCRICAO                                                                                       AS DescProduto,#(lf)--#(lf)    -- Dados devolucao#(lf)    CASE WHEN TRIM(ISNULL(D.DESCRICAO, '')) = '' THEN 'SEM MOTIVO INFORMADO' ELSE D.DESCRICAO END#(tab)#(tab)AS MotivoDevolucao,#(lf)#(tab)CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END   AS TipoIndenizacao,#(lf)#(tab)CASE#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'P' THEN 'RETORNO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'N' THEN 'NÃO INDENIZADO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'V' THEN 'INDENIZADO'#(lf)#(tab)#(tab)ELSE 'NÃO ENCONTRADO'#(lf)#(tab)END #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS TipoDevolucao,#(lf)--#(lf)#(tab)-- Dados NF referencia#(lf)    ENT.NF_REFERENCIA                                                                                   AS NfOriginal,#(lf)#(tab)ENT.SERIE_REFERENCI                                                                                 AS SerieOriginal,#(lf)#(tab)NOTA_ORIGINAL.DT_EMISSAO                                                                            AS EmissaoOriginal,#(lf)#(tab)CONCAT(FORMAT(ENT.NF_REFERENCIA, '0000000000'), '.', ENT.SERIE_REFERENCI)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS ChaveNfOriginal,#(lf)--#(lf)    -- Dados responsabilidade#(lf)#(tab)ISNULL(H.SUPERVISOR, 'SEM SUPERVISOR DEFINIDO')                                                   #(tab)AS Supervisor,#(lf)#(tab)ISNULL(H.VENDEDOR, 'SEM VENDEDOR DEFINIDO')                                                     #(tab)AS Vendedor,#(lf)#(tab)CASE #(tab)#(lf)#(tab)#(tab)WHEN H.CANAL IS NULL AND E.UF = 'EX' THEN 'EXPORTAÇÃO'#(lf)#(tab)#(tab)ELSE ISNULL(H.CANAL, 'SEM CANAL DEFINIDO')#(lf)#(tab)END#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Canal,#(lf)--#(lf)    -- Dados Transportadora da nota original#(lf)    TRANSP.CD_EMPRESA                                                                                   AS CdTransportadora,#(lf)#(tab)TRANSP.NOME_COMPLETO                                                                                AS RazaoTransportadora,#(lf)#(tab)TRANSP.FANTASIA                                                                                     AS FantasiaTransportadora,#(lf)#(tab)TRANSP.CNPJ_CPF                                                                                     AS CNPJTransportadora,#(lf)--#(lf)    -- Dados Numericos#(lf)#(tab)M.QUANTIDADE                                                                                        AS Quantidade,#(lf)#(tab)CASE WHEN M.UNI_MED = 'UN' THEN MAT.PESO ELSE 1 END * M.QUANTIDADE                                  AS Volume,#(lf)#(tab)M.PR_TOTAL_ITEM + M.VL_DESCONTO + M.TOTAL_DESP_ITEM + M.VL_IPI + M.VL_SUBSTITUICAO                  AS PrecoTotal,#(lf)#(tab)M.VL_IPI                                                                                            AS IPI,#(lf)#(tab)M.VL_ICMS                                                                                           AS ICMS#(lf)--#(lf)FROM CIGAM_RAW_DATA.dbo.ESMOVIME M#(lf)LEFT JOIN CIGAM_AUX.dbo.GETOPERA TP ON TP.CD_TIPO_OPERACA = M.CD_TP_OPERACAO#(lf)LEFT JOIN CIGAM_AUX.dbo.ESMATERI MAT ON MAT.CD_MATERIAL = M.CD_MATERIAL#(lf)LEFT JOIN CIGAM_CORE.dbo.COENTRAD ENT ON ENT.NF = M.NF AND ENT.SERIE = M.SERIE AND ENT.CD_FORNECEDOR  = M.CD_EMPRESA AND ENT.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN DADOBIER_DW.dbo.TB_MOTIVOS_DEVOLUCAO D ON D.MOVIMENTO = M.MOVIMENTO#(lf)--#(lf)LEFT JOIN CIGAM_CORE.dbo.FANFISCA NOTA_ORIGINAL ON NOTA_ORIGINAL.NF = ENT.NF_REFERENCIA AND NOTA_ORIGINAL.SERIE = 'NFE' AND NOTA_ORIGINAL.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES E ON E.CD_EMPRESA = CASE WHEN M.CD_EMPRESA = '000001' THEN NOTA_ORIGINAL.CD_CLIENTE ELSE M.CD_EMPRESA END#(lf)LEFT JOIN CIGAM_AUX.DBO.VETIPOEM ROTA ON ROTA.TIPO_DE_EMPRESA = E.TIPO_DE_EMPRESA#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES R ON R.CD_EMPRESA = E.CD_CENTRALIZADO#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES TRANSP ON TRANSP.CD_EMPRESA =  NOTA_ORIGINAL.CD_TRANSPORTADO#(lf)--#(lf)LEFT JOIN DADOBIER_DW.DBO.TB_ESTRUTURA_COMERCIAL_CERVEJA H ON H.CD_ROTA = E.TIPO_DE_EMPRESA#(lf)--#(lf)LEFT JOIN DADOBIER_ETL.DBO.TB_USUARIOS U ON U.CD_USUARIO = M.USU_CRIACAO#(lf)--#(lf)WHERE M.UNI_NEG = '01' AND DT_MOVIMENTO >= DATEFROMPARTS(2019,1,1) AND MAT.CD_GRUPO = '60' AND#(lf)(TP.CODIGO_NATUREZA IN (SELECT * FROM DATA_MANAGER.dbo.CFOPS_DEVOLUCOES) OR M.CD_TP_OPERACAO IN (SELECT * FROM DATA_MANAGER.dbo.TIPO_OPERACAO_DEVOLUCOES)) ", CommandTimeout=#duration(0, 0, 20, 0)]),
    #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Movimento", Int64.Type}, {"EmissaoDevolucao", type date}, {"EntradaDevolucao", type date}, {"EmissaoOriginal", type date}}),
    #"Rede Label" = Table.AddColumn(#"Tipo Alterado", "Rede_Label", each if [RedeRazao] is null or Text.Trim([RedeRazao]) = "" then
    if [RedeFantasia] is null or Text.Trim([RedeFantasia]) = "" 
    then "SEM REDE CADASTRADA" 
    else Text.Combine({[Rede], " - ", [RedeFantasia]})
else Text.Combine({[Rede], " - ", [RedeRazao], " (", [RedeFantasia], ")"})),
    #"Personalização Adicionada" = Table.AddColumn(#"Rede Label", "Cliente_Label", each if [ClienteRazao] is null or Text.Trim([ClienteRazao]) = "" 
then
    if [ClienteFantasia] is null or Text.Trim([ClienteFantasia]) = ""
    then "SEM REDE CADASTRADA" 
    else Text.Combine({[Cliente], " - ", [ClienteFantasia]})
else Text.Combine({[Cliente], " - ", [ClienteRazao], " (", [ClienteFantasia], ")"})),
    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Personalização Adicionada",{{"Rede_Label", type text}, {"Cliente_Label", type text}})
in
    #"Tipo Alterado1"</pre></td><td >False</td></tr><tr ><td >LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe</td><td ></td><td >Import</td><td ><pre>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoDevolucao])), 12, 31))</pre></td><td >True</td></tr><tr ><td >LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d</td><td ></td><td >Import</td><td ><pre>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EntradaDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EntradaDevolucao])), 12, 31))</pre></td><td >True</td></tr><tr ><td >LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048</td><td ></td><td >Import</td><td ><pre>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoOriginal])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoOriginal])), 12, 31))</pre></td><td >True</td></tr><tr ><td >Medidas</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText("i44FAA==", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#"Coluna 1" = _t]),
    #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Coluna 1", type text}}),
    #"Colunas Removidas" = Table.RemoveColumns(#"Tipo Alterado",{"Coluna 1"})
in
    #"Colunas Removidas"</pre></td><td >False</td></tr><tr ><td >PRODUTOS</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Sql.Database("192.168.1.249\DADOBIER_BI", "DADOBIER_ETL", [Query="SELECT#(lf)#(tab)M.CD_MATERIAL#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdProduto,#(lf)#(tab)M.DESCRICAO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Produto,#(lf)#(tab)N.NOME_MATERIAL #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Apelido,#(lf)#(tab)M.CD_UNIDADE_MEDI #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS UniMed,#(lf)#(tab)M.CD_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdGrupo,#(lf)#(tab)G.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Grupo,#(lf)#(tab)M.CD_SUB_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdSubgrupo,#(lf)#(tab)S.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Subgrupo,#(lf)#(tab)COALESCE(CG.NOME_GRUPO, 'Sem Grupo')#(tab)AS Agrupamento,#(lf)#(tab)COALESCE(CL.NOME_LINHA, 'Sem Linha')#(tab)AS Linha#(lf)FROM#(lf)#(tab)CIGAM_AUX.DBO.ESMATERI M#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESGRUPO G ON G.CD_GRUPO = M.CD_GRUPO#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESSUBGRU S ON S.CD_GRUPO = M.CD_GRUPO AND S.CD_SUB_GRUPO = M.CD_SUB_GRUPO#(lf)#(tab)LEFT JOIN DADOBIER_ETL.DBO.TB_NOMES_PERSONALIZADOS N ON N.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_PRODUTOS_LINHAS CPL ON CPL.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_LINHAS CL ON CL.ID_LINHA = CPL.ID_LINHA#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_GRUPOS CG ON CG.ID_GRUPO = CL.ID_GRUPO#(lf)WHERE#(lf)#(tab)M.CD_GRUPO = '60'#(lf)", CommandTimeout=#duration(0, 0, 20, 0)])
in
    Fonte</pre></td><td >False</td></tr></table><hr></hr><br></br><h3><div>List of Measures:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Measure Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
		<th>Dependency</th>
		<th>Reverse Dependency</th>
	</tr>
	<tr>
		<td>Quantidade</td>
		<td>Medidas</td>
		<td></td>
		<td><pre>SUM('DEVOLUÇÕES'[Quantidade])</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Quantidade</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: DEVOLUÇÕES</li>
<li><span class="caret">Column: Quantidade (Table: DEVOLUÇÕES)</span>
<ul class="nested">
<li>Table: DEVOLUÇÕES   ...</li>
<li>Column: Quantidade (Table: DEVOLUÇÕES)   ...</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Quantidade</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: Quantidade</span>
<ul class="nested">
<li>Measure: Quantidade ...</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>Volume</td>
		<td>Medidas</td>
		<td></td>
		<td><pre>SUM('DEVOLUÇÕES'[Volume])</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Volume</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: DEVOLUÇÕES</li>
<li><span class="caret">Column: Volume (Table: DEVOLUÇÕES)</span>
<ul class="nested">
<li>Table: DEVOLUÇÕES   ...</li>
<li>Column: Volume (Table: DEVOLUÇÕES)   ...</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Volume</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: Volume</span>
<ul class="nested">
<li>Measure: Volume ...</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>PrecoTotal</td>
		<td>Medidas</td>
		<td></td>
		<td><pre>sum('DEVOLUÇÕES'[PrecoTotal])</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: PrecoTotal</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: DEVOLUÇÕES</li>
<li><span class="caret">Column: PrecoTotal (Table: DEVOLUÇÕES)</span>
<ul class="nested">
<li>Table: DEVOLUÇÕES   ...</li>
<li>Column: PrecoTotal (Table: DEVOLUÇÕES)   ...</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: PrecoTotal</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: PrecoTotal</span>
<ul class="nested">
<li>Measure: PrecoTotal ...</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table DEVOLUÇÕES:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>CFOP</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Movimento</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TipoOperacao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DescCFOP</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Cliente</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ClienteRazao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ClienteFantasia</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ClienteUF</td>
		<td>Estado da criatura</td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ClienteMunicipio</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CdRota</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NomeRota</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Rede</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>RedeRazao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>RedeFantasia</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>SerieDevolucao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NFDevolucao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>EmissaoDevolucao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>EntradaDevolucao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Usuario</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CdUsuario</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NomeUsuario</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CodProduto</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DescProduto</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>MotivoDevolucao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TipoIndenizacao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NfOriginal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>SerieOriginal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>EmissaoOriginal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ChaveNfOriginal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Supervisor</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Vendedor</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Canal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CdTransportadora</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>RazaoTransportadora</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>FantasiaTransportadora</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CNPJTransportadora</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Quantidade</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Volume</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>PrecoTotal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>IPI</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ICMS</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TipoDevolucao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Rede_Label</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Cliente_Label</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Medidas:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table PRODUTOS:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>CdProduto</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Produto</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Apelido</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>UniMed</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CdGrupo</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Grupo</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CdSubgrupo</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Subgrupo</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Agrupamento</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Linha</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Roles:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Role Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>Relationships:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >CrossFilteringBehavior</td><td >FromCardinality</td><td >FromColumn</td><td >FromTable</td><td >IsActive</td><td >IsRemoved</td><td >JoinOnDateBehavior</td><td >RelyOnReferentialIntegrity</td><td >SecurityFilteringBehavior</td><td >State</td><td >ToCardinality</td><td >ToColumn</td><td >ToTable</td><td >Type</td></tr><tr ><td >515e96fe-8e39-4138-9193-0495feab1429</td><td >OneDirection</td><td >Many</td><td >EmissaoDevolucao</td><td >DEVOLUÇÕES</td><td >True</td><td >False</td><td >DatePartOnly</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe</td><td >SingleColumn</td></tr><tr ><td >2e214fd4-7020-4cea-afdb-e41ddb94370d</td><td >OneDirection</td><td >Many</td><td >EntradaDevolucao</td><td >DEVOLUÇÕES</td><td >True</td><td >False</td><td >DatePartOnly</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d</td><td >SingleColumn</td></tr><tr ><td >459152bf-fa19-45bb-af29-84f69e7846c6</td><td >OneDirection</td><td >Many</td><td >EmissaoOriginal</td><td >DEVOLUÇÕES</td><td >True</td><td >False</td><td >DatePartOnly</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048</td><td >SingleColumn</td></tr><tr ><td >6c088134-2714-4890-aece-e1a86a834bdf</td><td >OneDirection</td><td >Many</td><td >CodProduto</td><td >DEVOLUÇÕES</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >CdProduto</td><td >PRODUTOS</td><td >SingleColumn</td></tr></table><hr></hr><br></br><h2><div>M (Power Query) Script:</div></h2><br></br><br></br><font face="verdana" size="2"<div>DateTableTemplate_56af38da-5a48-4aa0-89f3-22215533f47c-f2c431bf-9700-4f48-9bfe-988e99e967d4<br></br><br></br>Calendar(Date(2015,1,1), Date(2015,1,1))<br></br><br></br><br></br>----------------------<br></br>DEVOLUÇÕES-97f4a9e8-0a35-4747-a05d-ba1a93e1ac91<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Sql.Database</font>(<font color="red">"192.168.1.249\DADOBIER_BI"</font>, <font color="red">"DADOBIER_ETL"</font>, [Query="--CREATE VIEW [dbo].[RELATORIO_DEVOLUCOES] AS#(lf)SELECT#(lf)    -- Dados categoricos#(lf)--#(lf)    -- Dados base#(lf)#(tab)M.MOVIMENTO                                                                                         AS Movimento,#(lf)#(tab)M.CFOP                                                                                              AS CFOP,#(lf)#(tab)M.CD_TP_OPERACAO                                                                                    AS TipoOperacao,#(lf)#(tab)TP.DESCRICAO                                                                                        AS DescCFOP,#(lf)--#(lf)    -- Dados Cliente#(lf)#(tab)E.CD_EMPRESA                                                                                        AS Cliente,#(lf)#(tab)E.NOME_COMPLETO                                                                                     AS ClienteRazao,#(lf)#(tab)E.FANTASIA                                                                                          AS ClienteFantasia,#(lf)#(tab)E.UF                                                                                                AS ClienteUF,#(lf)#(tab)E.MUNICIPIO                                                                                         AS ClienteMunicipio,#(lf)#(tab)ISNULL(E.TIPO_DE_EMPRESA, '00')                                                                     AS CdRota,#(lf)#(tab)ISNULL(ROTA.DESCRICAO, 'SEM ROTA DEFINIDA')                                                         AS NomeRota,#(lf)#(tab)ISNULL(R.CD_EMPRESA , E.CD_EMPRESA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Rede,#(lf)#(tab)CASE WHEN TRIM(ISNULL(R.NOME_COMPLETO, '')) = '' THEN E.NOME_COMPLETO ELSE R.NOME_COMPLETO END      AS RedeRazao,#(lf)#(tab)ISNULL(R.FANTASIA , E.FANTASIA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS RedeFantasia,#(lf)--#(lf)    -- Dados nota#(lf)#(tab)M.SERIE                                                                                             AS SerieDevolucao, #(lf)    M.NF                                                                                                AS NFDevolucao,#(lf)#(tab)ENT.DT_EMISSAO                                                                                      AS EmissaoDevolucao,#(lf)#(tab)M.DT_MOVIMENTO                                                                                      AS EntradaDevolucao,#(lf)#(tab)U.USUARIO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Usuario,#(lf)#(tab)M.USU_CRIACAO                                                                                       AS CdUsuario,#(lf)#(tab)U.NOME#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS NomeUsuario,#(lf)--#(lf)    -- Dados de produto#(lf)#(tab)MAT.CD_MATERIAL                                                                              #(tab)#(tab)AS CodProduto,#(lf)#(tab)MAT.DESCRICAO                                                                                       AS DescProduto,#(lf)--#(lf)    -- Dados devolucao#(lf)    CASE WHEN TRIM(ISNULL(D.DESCRICAO, '')) = '' THEN 'SEM MOTIVO INFORMADO' ELSE D.DESCRICAO END#(tab)#(tab)AS MotivoDevolucao,#(lf)#(tab)CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END   AS TipoIndenizacao,#(lf)#(tab)CASE#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'P' THEN 'RETORNO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'N' THEN 'NÃO INDENIZADO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'V' THEN 'INDENIZADO'#(lf)#(tab)#(tab)ELSE 'NÃO ENCONTRADO'#(lf)#(tab)END #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS TipoDevolucao,#(lf)--#(lf)#(tab)-- Dados NF referencia#(lf)    ENT.NF_REFERENCIA                                                                                   AS NfOriginal,#(lf)#(tab)ENT.SERIE_REFERENCI                                                                                 AS SerieOriginal,#(lf)#(tab)NOTA_ORIGINAL.DT_EMISSAO                                                                            AS EmissaoOriginal,#(lf)#(tab)CONCAT(FORMAT(ENT.NF_REFERENCIA, '0000000000'), '.', ENT.SERIE_REFERENCI)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS ChaveNfOriginal,#(lf)--#(lf)    -- Dados responsabilidade#(lf)#(tab)ISNULL(H.SUPERVISOR, 'SEM SUPERVISOR DEFINIDO')                                                   #(tab)AS Supervisor,#(lf)#(tab)ISNULL(H.VENDEDOR, 'SEM VENDEDOR DEFINIDO')                                                     #(tab)AS Vendedor,#(lf)#(tab)CASE #(tab)#(lf)#(tab)#(tab)WHEN H.CANAL IS NULL AND E.UF = 'EX' THEN 'EXPORTAÇÃO'#(lf)#(tab)#(tab)ELSE ISNULL(H.CANAL, 'SEM CANAL DEFINIDO')#(lf)#(tab)END#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Canal,#(lf)--#(lf)    -- Dados Transportadora da nota original#(lf)    TRANSP.CD_EMPRESA                                                                                   AS CdTransportadora,#(lf)#(tab)TRANSP.NOME_COMPLETO                                                                                AS RazaoTransportadora,#(lf)#(tab)TRANSP.FANTASIA                                                                                     AS FantasiaTransportadora,#(lf)#(tab)TRANSP.CNPJ_CPF                                                                                     AS CNPJTransportadora,#(lf)--#(lf)    -- Dados Numericos#(lf)#(tab)M.QUANTIDADE                                                                                        AS Quantidade,#(lf)#(tab)CASE WHEN M.UNI_MED = 'UN' THEN MAT.PESO ELSE 1 END * M.QUANTIDADE                                  AS Volume,#(lf)#(tab)M.PR_TOTAL_ITEM + M.VL_DESCONTO + M.TOTAL_DESP_ITEM + M.VL_IPI + M.VL_SUBSTITUICAO                  AS PrecoTotal,#(lf)#(tab)M.VL_IPI                                                                                            AS IPI,#(lf)#(tab)M.VL_ICMS                                                                                           AS ICMS#(lf)--#(lf)FROM CIGAM_RAW_DATA.dbo.ESMOVIME M#(lf)LEFT JOIN CIGAM_AUX.dbo.GETOPERA TP ON TP.CD_TIPO_OPERACA = M.CD_TP_OPERACAO#(lf)LEFT JOIN CIGAM_AUX.dbo.ESMATERI MAT ON MAT.CD_MATERIAL = M.CD_MATERIAL#(lf)LEFT JOIN CIGAM_CORE.dbo.COENTRAD ENT ON ENT.NF = M.NF AND ENT.SERIE = M.SERIE AND ENT.CD_FORNECEDOR  = M.CD_EMPRESA AND ENT.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN DADOBIER_DW.dbo.TB_MOTIVOS_DEVOLUCAO D ON D.MOVIMENTO = M.MOVIMENTO#(lf)--#(lf)LEFT JOIN CIGAM_CORE.dbo.FANFISCA NOTA_ORIGINAL ON NOTA_ORIGINAL.NF = ENT.NF_REFERENCIA AND NOTA_ORIGINAL.SERIE = 'NFE' AND NOTA_ORIGINAL.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES E ON E.CD_EMPRESA = CASE WHEN M.CD_EMPRESA = '000001' THEN NOTA_ORIGINAL.CD_CLIENTE ELSE M.CD_EMPRESA END#(lf)LEFT JOIN CIGAM_AUX.DBO.VETIPOEM ROTA ON ROTA.TIPO_DE_EMPRESA = E.TIPO_DE_EMPRESA#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES R ON R.CD_EMPRESA = E.CD_CENTRALIZADO#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES TRANSP ON TRANSP.CD_EMPRESA =  NOTA_ORIGINAL.CD_TRANSPORTADO#(lf)--#(lf)LEFT JOIN DADOBIER_DW.DBO.TB_ESTRUTURA_COMERCIAL_CERVEJA H ON H.CD_ROTA = E.TIPO_DE_EMPRESA#(lf)--#(lf)LEFT JOIN DADOBIER_ETL.DBO.TB_USUARIOS U ON U.CD_USUARIO = M.USU_CRIACAO#(lf)--#(lf)WHERE M.UNI_NEG = '01' AND DT_MOVIMENTO >= DATEFROMPARTS(2019,1,1) AND MAT.CD_GRUPO = '60' AND#(lf)(TP.CODIGO_NATUREZA IN (SELECT * FROM DATA_MANAGER.dbo.CFOPS_DEVOLUCOES) OR M.CD_TP_OPERACAO IN (SELECT * FROM DATA_MANAGER.dbo.TIPO_OPERACAO_DEVOLUCOES)) ", CommandTimeout=#duration(0, 0, 20, 0)]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Movimento"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"EmissaoDevolucao"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"EntradaDevolucao"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"EmissaoOriginal"</font>, <font color="blue">type</font> <font color="blue">date</font>}}),<br></br>    #<font color="red">"Rede Label"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Tipo Alterado"</font>, <font color="red">"Rede_Label"</font>, each if [RedeRazao] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([RedeRazao]) = <font color="red">""</font> then<br></br>    if [RedeFantasia] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([RedeFantasia]) = <font color="red">""</font> <br></br>    then <font color="red">"SEM REDE CADASTRADA"</font> <br></br>    else <font color="purple">Text.Combine</font>({[Rede], " - ", [RedeFantasia]})<br></br>else <font color="purple">Text.Combine</font>({[Rede], " - ", [RedeRazao], " (", [RedeFantasia], ")"})),<br></br>    #<font color="red">"Personalização Adicionada"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Rede Label"</font>, <font color="red">"Cliente_Label"</font>, each if [ClienteRazao] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([ClienteRazao]) = <font color="red">""</font> <br></br>then<br></br>    if [ClienteFantasia] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([ClienteFantasia]) = <font color="red">""</font><br></br>    then <font color="red">"SEM REDE CADASTRADA"</font> <br></br>    else <font color="purple">Text.Combine</font>({[Cliente], " - ", [ClienteFantasia]})<br></br>else <font color="purple">Text.Combine</font>({[Cliente], " - ", [ClienteRazao], " (", [ClienteFantasia], ")"})),<br></br>    #<font color="red">"Tipo Alterado1"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Personalização Adicionada"</font>,{{<font color="red">"Rede_Label"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Cliente_Label"</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado1"</font><br></br><br></br><br></br>----------------------<br></br>LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe-e006dac6-8c02-4507-a2f3-7775c3b75d96<br></br><br></br>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoDevolucao])), 12, 31))<br></br><br></br><br></br>----------------------<br></br>LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d-08a1c732-d407-489f-a29d-525b764945fd<br></br><br></br>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EntradaDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EntradaDevolucao])), 12, 31))<br></br><br></br><br></br>----------------------<br></br>LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048-7ccd131f-93f6-456b-a074-b49369906417<br></br><br></br>Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoOriginal])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoOriginal])), 12, 31))<br></br><br></br><br></br>----------------------<br></br>Medidas-87538b6d-6a4f-4334-b2b0-5b439723f2bc<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font><br></br><br></br><br></br>----------------------<br></br>PRODUTOS-7d537543-2a7c-4653-aca3-14c2e63b8441<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Sql.Database</font>(<font color="red">"192.168.1.249\DADOBIER_BI"</font>, <font color="red">"DADOBIER_ETL"</font>, [Query="SELECT#(lf)#(tab)M.CD_MATERIAL#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdProduto,#(lf)#(tab)M.DESCRICAO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Produto,#(lf)#(tab)N.NOME_MATERIAL #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Apelido,#(lf)#(tab)M.CD_UNIDADE_MEDI #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS UniMed,#(lf)#(tab)M.CD_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdGrupo,#(lf)#(tab)G.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Grupo,#(lf)#(tab)M.CD_SUB_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdSubgrupo,#(lf)#(tab)S.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Subgrupo,#(lf)#(tab)COALESCE(CG.NOME_GRUPO, 'Sem Grupo')#(tab)AS Agrupamento,#(lf)#(tab)COALESCE(CL.NOME_LINHA, 'Sem Linha')#(tab)AS Linha#(lf)FROM#(lf)#(tab)CIGAM_AUX.DBO.ESMATERI M#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESGRUPO G ON G.CD_GRUPO = M.CD_GRUPO#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESSUBGRU S ON S.CD_GRUPO = M.CD_GRUPO AND S.CD_SUB_GRUPO = M.CD_SUB_GRUPO#(lf)#(tab)LEFT JOIN DADOBIER_ETL.DBO.TB_NOMES_PERSONALIZADOS N ON N.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_PRODUTOS_LINHAS CPL ON CPL.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_LINHAS CL ON CL.ID_LINHA = CPL.ID_LINHA#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_GRUPOS CG ON CG.ID_GRUPO = CL.ID_GRUPO#(lf)WHERE#(lf)#(tab)M.CD_GRUPO = '60'#(lf)", CommandTimeout=#duration(0, 0, 20, 0)])<br></br><font color="blue">in</font><br></br>    Fonte<br></br><br></br><br></br>----------------------<br></br></font></div><br></br><hr></hr><br></br><h3><div>Partitions:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >QueryDefinition</td></tr><tr ><td >DateTableTemplate_56af38da-5a48-4aa0-89f3-22215533f47c-f2c431bf-9700-4f48-9bfe-988e99e967d4</td><td >Calendar(Date(2015,1,1), Date(2015,1,1))</td></tr><tr ><td >DEVOLUÇÕES-97f4a9e8-0a35-4747-a05d-ba1a93e1ac91</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Sql.Database</font>(<font color="red">"192.168.1.249\DADOBIER_BI"</font>, <font color="red">"DADOBIER_ETL"</font>, [Query="--CREATE VIEW [dbo].[RELATORIO_DEVOLUCOES] AS#(lf)SELECT#(lf)    -- Dados categoricos#(lf)--#(lf)    -- Dados base#(lf)#(tab)M.MOVIMENTO                                                                                         AS Movimento,#(lf)#(tab)M.CFOP                                                                                              AS CFOP,#(lf)#(tab)M.CD_TP_OPERACAO                                                                                    AS TipoOperacao,#(lf)#(tab)TP.DESCRICAO                                                                                        AS DescCFOP,#(lf)--#(lf)    -- Dados Cliente#(lf)#(tab)E.CD_EMPRESA                                                                                        AS Cliente,#(lf)#(tab)E.NOME_COMPLETO                                                                                     AS ClienteRazao,#(lf)#(tab)E.FANTASIA                                                                                          AS ClienteFantasia,#(lf)#(tab)E.UF                                                                                                AS ClienteUF,#(lf)#(tab)E.MUNICIPIO                                                                                         AS ClienteMunicipio,#(lf)#(tab)ISNULL(E.TIPO_DE_EMPRESA, '00')                                                                     AS CdRota,#(lf)#(tab)ISNULL(ROTA.DESCRICAO, 'SEM ROTA DEFINIDA')                                                         AS NomeRota,#(lf)#(tab)ISNULL(R.CD_EMPRESA , E.CD_EMPRESA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Rede,#(lf)#(tab)CASE WHEN TRIM(ISNULL(R.NOME_COMPLETO, '')) = '' THEN E.NOME_COMPLETO ELSE R.NOME_COMPLETO END      AS RedeRazao,#(lf)#(tab)ISNULL(R.FANTASIA , E.FANTASIA)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS RedeFantasia,#(lf)--#(lf)    -- Dados nota#(lf)#(tab)M.SERIE                                                                                             AS SerieDevolucao, #(lf)    M.NF                                                                                                AS NFDevolucao,#(lf)#(tab)ENT.DT_EMISSAO                                                                                      AS EmissaoDevolucao,#(lf)#(tab)M.DT_MOVIMENTO                                                                                      AS EntradaDevolucao,#(lf)#(tab)U.USUARIO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Usuario,#(lf)#(tab)M.USU_CRIACAO                                                                                       AS CdUsuario,#(lf)#(tab)U.NOME#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS NomeUsuario,#(lf)--#(lf)    -- Dados de produto#(lf)#(tab)MAT.CD_MATERIAL                                                                              #(tab)#(tab)AS CodProduto,#(lf)#(tab)MAT.DESCRICAO                                                                                       AS DescProduto,#(lf)--#(lf)    -- Dados devolucao#(lf)    CASE WHEN TRIM(ISNULL(D.DESCRICAO, '')) = '' THEN 'SEM MOTIVO INFORMADO' ELSE D.DESCRICAO END#(tab)#(tab)AS MotivoDevolucao,#(lf)#(tab)CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END   AS TipoIndenizacao,#(lf)#(tab)CASE#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'P' THEN 'RETORNO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'N' THEN 'NÃO INDENIZADO'#(lf)#(tab)#(tab)WHEN CASE WHEN ISNULL(D.TIPO_INDENIZ,'') = '' OR D.TIPO_INDENIZ = ' ' THEN 'N' ELSE D.TIPO_INDENIZ END = 'V' THEN 'INDENIZADO'#(lf)#(tab)#(tab)ELSE 'NÃO ENCONTRADO'#(lf)#(tab)END #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS TipoDevolucao,#(lf)--#(lf)#(tab)-- Dados NF referencia#(lf)    ENT.NF_REFERENCIA                                                                                   AS NfOriginal,#(lf)#(tab)ENT.SERIE_REFERENCI                                                                                 AS SerieOriginal,#(lf)#(tab)NOTA_ORIGINAL.DT_EMISSAO                                                                            AS EmissaoOriginal,#(lf)#(tab)CONCAT(FORMAT(ENT.NF_REFERENCIA, '0000000000'), '.', ENT.SERIE_REFERENCI)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS ChaveNfOriginal,#(lf)--#(lf)    -- Dados responsabilidade#(lf)#(tab)ISNULL(H.SUPERVISOR, 'SEM SUPERVISOR DEFINIDO')                                                   #(tab)AS Supervisor,#(lf)#(tab)ISNULL(H.VENDEDOR, 'SEM VENDEDOR DEFINIDO')                                                     #(tab)AS Vendedor,#(lf)#(tab)CASE #(tab)#(lf)#(tab)#(tab)WHEN H.CANAL IS NULL AND E.UF = 'EX' THEN 'EXPORTAÇÃO'#(lf)#(tab)#(tab)ELSE ISNULL(H.CANAL, 'SEM CANAL DEFINIDO')#(lf)#(tab)END#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Canal,#(lf)--#(lf)    -- Dados Transportadora da nota original#(lf)    TRANSP.CD_EMPRESA                                                                                   AS CdTransportadora,#(lf)#(tab)TRANSP.NOME_COMPLETO                                                                                AS RazaoTransportadora,#(lf)#(tab)TRANSP.FANTASIA                                                                                     AS FantasiaTransportadora,#(lf)#(tab)TRANSP.CNPJ_CPF                                                                                     AS CNPJTransportadora,#(lf)--#(lf)    -- Dados Numericos#(lf)#(tab)M.QUANTIDADE                                                                                        AS Quantidade,#(lf)#(tab)CASE WHEN M.UNI_MED = 'UN' THEN MAT.PESO ELSE 1 END * M.QUANTIDADE                                  AS Volume,#(lf)#(tab)M.PR_TOTAL_ITEM + M.VL_DESCONTO + M.TOTAL_DESP_ITEM + M.VL_IPI + M.VL_SUBSTITUICAO                  AS PrecoTotal,#(lf)#(tab)M.VL_IPI                                                                                            AS IPI,#(lf)#(tab)M.VL_ICMS                                                                                           AS ICMS#(lf)--#(lf)FROM CIGAM_RAW_DATA.dbo.ESMOVIME M#(lf)LEFT JOIN CIGAM_AUX.dbo.GETOPERA TP ON TP.CD_TIPO_OPERACA = M.CD_TP_OPERACAO#(lf)LEFT JOIN CIGAM_AUX.dbo.ESMATERI MAT ON MAT.CD_MATERIAL = M.CD_MATERIAL#(lf)LEFT JOIN CIGAM_CORE.dbo.COENTRAD ENT ON ENT.NF = M.NF AND ENT.SERIE = M.SERIE AND ENT.CD_FORNECEDOR  = M.CD_EMPRESA AND ENT.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN DADOBIER_DW.dbo.TB_MOTIVOS_DEVOLUCAO D ON D.MOVIMENTO = M.MOVIMENTO#(lf)--#(lf)LEFT JOIN CIGAM_CORE.dbo.FANFISCA NOTA_ORIGINAL ON NOTA_ORIGINAL.NF = ENT.NF_REFERENCIA AND NOTA_ORIGINAL.SERIE = 'NFE' AND NOTA_ORIGINAL.CD_UNIDADE_DE_N = M.UNI_NEG#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES E ON E.CD_EMPRESA = CASE WHEN M.CD_EMPRESA = '000001' THEN NOTA_ORIGINAL.CD_CLIENTE ELSE M.CD_EMPRESA END#(lf)LEFT JOIN CIGAM_AUX.DBO.VETIPOEM ROTA ON ROTA.TIPO_DE_EMPRESA = E.TIPO_DE_EMPRESA#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES R ON R.CD_EMPRESA = E.CD_CENTRALIZADO#(lf)LEFT JOIN CIGAM_AUX.DBO.GEEMPRES TRANSP ON TRANSP.CD_EMPRESA =  NOTA_ORIGINAL.CD_TRANSPORTADO#(lf)--#(lf)LEFT JOIN DADOBIER_DW.DBO.TB_ESTRUTURA_COMERCIAL_CERVEJA H ON H.CD_ROTA = E.TIPO_DE_EMPRESA#(lf)--#(lf)LEFT JOIN DADOBIER_ETL.DBO.TB_USUARIOS U ON U.CD_USUARIO = M.USU_CRIACAO#(lf)--#(lf)WHERE M.UNI_NEG = '01' AND DT_MOVIMENTO >= DATEFROMPARTS(2019,1,1) AND MAT.CD_GRUPO = '60' AND#(lf)(TP.CODIGO_NATUREZA IN (SELECT * FROM DATA_MANAGER.dbo.CFOPS_DEVOLUCOES) OR M.CD_TP_OPERACAO IN (SELECT * FROM DATA_MANAGER.dbo.TIPO_OPERACAO_DEVOLUCOES)) ", CommandTimeout=#duration(0, 0, 20, 0)]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Movimento"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"EmissaoDevolucao"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"EntradaDevolucao"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"EmissaoOriginal"</font>, <font color="blue">type</font> <font color="blue">date</font>}}),<br></br>    #<font color="red">"Rede Label"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Tipo Alterado"</font>, <font color="red">"Rede_Label"</font>, each if [RedeRazao] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([RedeRazao]) = <font color="red">""</font> then<br></br>    if [RedeFantasia] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([RedeFantasia]) = <font color="red">""</font> <br></br>    then <font color="red">"SEM REDE CADASTRADA"</font> <br></br>    else <font color="purple">Text.Combine</font>({[Rede], " - ", [RedeFantasia]})<br></br>else <font color="purple">Text.Combine</font>({[Rede], " - ", [RedeRazao], " (", [RedeFantasia], ")"})),<br></br>    #<font color="red">"Personalização Adicionada"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Rede Label"</font>, <font color="red">"Cliente_Label"</font>, each if [ClienteRazao] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([ClienteRazao]) = <font color="red">""</font> <br></br>then<br></br>    if [ClienteFantasia] is <font color="blue">null</font> or <font color="purple">Text.Trim</font>([ClienteFantasia]) = <font color="red">""</font><br></br>    then <font color="red">"SEM REDE CADASTRADA"</font> <br></br>    else <font color="purple">Text.Combine</font>({[Cliente], " - ", [ClienteFantasia]})<br></br>else <font color="purple">Text.Combine</font>({[Cliente], " - ", [ClienteRazao], " (", [ClienteFantasia], ")"})),<br></br>    #<font color="red">"Tipo Alterado1"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Personalização Adicionada"</font>,{{<font color="red">"Rede_Label"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Cliente_Label"</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado1"</font></td></tr><tr ><td >LocalDateTable_28d2d0b1-b25c-40ad-ab2c-69ed6e3128fe-e006dac6-8c02-4507-a2f3-7775c3b75d96</td><td >Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoDevolucao])), 12, 31))</td></tr><tr ><td >LocalDateTable_be866b2d-6b25-4277-8513-44a41dcb0b7d-08a1c732-d407-489f-a29d-525b764945fd</td><td >Calendar(Date(Year(MIN('DEVOLUÇÕES'[EntradaDevolucao])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EntradaDevolucao])), 12, 31))</td></tr><tr ><td >LocalDateTable_4bd394f7-4ccc-48a8-9889-1cec9e260048-7ccd131f-93f6-456b-a074-b49369906417</td><td >Calendar(Date(Year(MIN('DEVOLUÇÕES'[EmissaoOriginal])), 1, 1), Date(Year(MAX('DEVOLUÇÕES'[EmissaoOriginal])), 12, 31))</td></tr><tr ><td >Medidas-87538b6d-6a4f-4334-b2b0-5b439723f2bc</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font></td></tr><tr ><td >PRODUTOS-7d537543-2a7c-4653-aca3-14c2e63b8441</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Sql.Database</font>(<font color="red">"192.168.1.249\DADOBIER_BI"</font>, <font color="red">"DADOBIER_ETL"</font>, [Query="SELECT#(lf)#(tab)M.CD_MATERIAL#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdProduto,#(lf)#(tab)M.DESCRICAO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Produto,#(lf)#(tab)N.NOME_MATERIAL #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Apelido,#(lf)#(tab)M.CD_UNIDADE_MEDI #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS UniMed,#(lf)#(tab)M.CD_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdGrupo,#(lf)#(tab)G.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Grupo,#(lf)#(tab)M.CD_SUB_GRUPO#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS CdSubgrupo,#(lf)#(tab)S.DESCRICAO #(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)AS Subgrupo,#(lf)#(tab)COALESCE(CG.NOME_GRUPO, 'Sem Grupo')#(tab)AS Agrupamento,#(lf)#(tab)COALESCE(CL.NOME_LINHA, 'Sem Linha')#(tab)AS Linha#(lf)FROM#(lf)#(tab)CIGAM_AUX.DBO.ESMATERI M#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESGRUPO G ON G.CD_GRUPO = M.CD_GRUPO#(lf)#(tab)LEFT JOIN CIGAM_AUX.DBO.ESSUBGRU S ON S.CD_GRUPO = M.CD_GRUPO AND S.CD_SUB_GRUPO = M.CD_SUB_GRUPO#(lf)#(tab)LEFT JOIN DADOBIER_ETL.DBO.TB_NOMES_PERSONALIZADOS N ON N.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_PRODUTOS_LINHAS CPL ON CPL.CD_MATERIAL = M.CD_MATERIAL#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_LINHAS CL ON CL.ID_LINHA = CPL.ID_LINHA#(lf)#(tab)LEFT JOIN DATA_MANAGER.DBO.CERVEJA_GRUPOS CG ON CG.ID_GRUPO = CL.ID_GRUPO#(lf)WHERE#(lf)#(tab)M.CD_GRUPO = '60'#(lf)", CommandTimeout=#duration(0, 0, 20, 0)])<br></br><font color="blue">in</font><br></br>    Fonte</td></tr></table><script>
	var toggler = document.getElementsByClassName("caret");
	for (var i = 0; i < toggler.length; i++){
		toggler[i].addEventListener("click", function() {
			this.parentElement.querySelector(".nested").classList.toggle("active");
		});
	}
		
	var togglerAll = document.getElementsByClassName("dropDownCaret");
	for (var j=0; j<togglerAll.length; j++){
		togglerAll[j].addEventListener("click", function(event){
			if (event.currentTarget != event.target) return;
			if(this.parentElement.querySelector(".nested").classList.contains("active")){
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(currentValue.classList.contains("active")){
						currentValue.classList.remove("active");
					}
				});
			}
			else{
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(!currentValue.classList.contains("active")){
						currentValue.classList.add("active");
					}
				});
			}
		});
	}
</script></body></html>